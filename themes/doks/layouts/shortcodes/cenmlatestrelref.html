{{/*
  Usage:
  {{< cenmlatestrelref "cenm/angel-service.md" "Link text" "1.2.3" >}}

  Arguments:
    0 = target page path (e.g. "cenm/angel-service" or "cenm/angel-service.md"), relative to the CENM version folder
    1 = link text
    2 = version (optional; defaults to latest from site.Params.cenmversions)
*/}}

{{- $rawTarget := .Get 0 -}}
{{- $text := .Get 1 -}}
{{- $version := .Get 2 | default (replace (index .Site.Params.cenmversions 0) "CENM " "") -}}

{{/* Normalize path: replace backslashes, strip .md if present */}}
{{- $target := replace $rawTarget "\\" "/" -}}
{{- $target = strings.TrimSuffix ".md" $target -}}

{{/* Final relative path from content root */}}
{{- $relPath := printf "en/platform/corda/%s/%s" $version $target -}}

{{- with $rel := $relPath | relref . -}}
  <a href="{{ $rel }}">{{ $text }}</a>
{{- else -}}
  <span style="color:red;">Link not found: {{ $relPath }}</span>
{{- end }}