<HTML>
<HEAD>
<meta charset="UTF-8">
<title>net.corda.core.internal - corda</title>
<link rel="stylesheet" href="../../style.css">

<meta name="docsearch:language" content="en">
<meta name="docsearch:version" content="1.0">
<meta name="docsearch:project" content="corda-os">
</head>
<BODY>
<a href="../index.html">corda</a>&nbsp;/&nbsp;<a href=".">net.corda.core.internal</a><br/>
<br/>
<h2>Package net.corda.core.internal</h2>
<h3>Types</h3>
<table>
<tbody>
<tr>
<td>
<p><a href="-abstract-attachment/index.html">AbstractAttachment</a></p>
</td>
<td>
<code><span class="keyword">abstract</span> <span class="keyword">class </span><span class="identifier">AbstractAttachment</span>&nbsp;<span class="symbol">:</span>&nbsp;<a href="../net.corda.core.contracts/-attachment/index.html"><span class="identifier">Attachment</span></a></code></td>
</tr>
<tr>
<td>
<p><a href="-contract-upgrade-utils/index.html">ContractUpgradeUtils</a></p>
</td>
<td>
<code><span class="keyword">object </span><span class="identifier">ContractUpgradeUtils</span></code></td>
</tr>
<tr>
<td>
<p><a href="-declared-field/index.html">DeclaredField</a></p>
</td>
<td>
<code><span class="keyword">class </span><span class="identifier">DeclaredField</span><span class="symbol">&lt;</span><span class="identifier">T</span><span class="symbol">&gt;</span></code>
<p>A simple wrapper around a <a href="#">Field</a> object providing type safe read and write access using <a href="-declared-field/value.html">value</a>, ignoring the field's
visibility.</p>
</td>
</tr>
<tr>
<td>
<p><a href="-emoji/index.html">Emoji</a></p>
</td>
<td>
<code><span class="keyword">object </span><span class="identifier">Emoji</span></code>
<p>A simple wrapper class that contains icons and support for printing them only when we're connected to a terminal.</p>
</td>
</tr>
<tr>
<td>
<p><a href="-fetch-attachments-flow/index.html">FetchAttachmentsFlow</a></p>
</td>
<td>
<code><span class="keyword">class </span><span class="identifier">FetchAttachmentsFlow</span>&nbsp;<span class="symbol">:</span>&nbsp;<a href="-fetch-data-flow/index.html"><span class="identifier">FetchDataFlow</span></a><span class="symbol">&lt;</span><a href="../net.corda.core.contracts/-attachment/index.html"><span class="identifier">Attachment</span></a><span class="symbol">,</span>&nbsp;<a href="https://kotlinlang.org/api/latest/jvm/stdlib/kotlin/-byte-array/index.html"><span class="identifier">ByteArray</span></a><span class="symbol">&gt;</span></code>
<p>Given a set of hashes either loads from from local storage  or requests them from the other peer. Downloaded
attachments are saved to local storage automatically.</p>
</td>
</tr>
<tr>
<td>
<p><a href="-fetch-data-flow/index.html">FetchDataFlow</a></p>
</td>
<td>
<code><span class="keyword">sealed</span> <span class="keyword">class </span><span class="identifier">FetchDataFlow</span><span class="symbol">&lt;</span><span class="identifier">T</span>&nbsp;<span class="symbol">:</span>&nbsp;<a href="../net.corda.core.contracts/-named-by-hash/index.html"><span class="identifier">NamedByHash</span></a><span class="symbol">, </span><span class="keyword">in</span>&nbsp;<span class="identifier">W</span>&nbsp;<span class="symbol">:</span>&nbsp;<a href="https://kotlinlang.org/api/latest/jvm/stdlib/kotlin/-any/index.html"><span class="identifier">Any</span></a><span class="symbol">&gt;</span>&nbsp;<span class="symbol">:</span>&nbsp;<a href="../net.corda.core.flows/-flow-logic/index.html"><span class="identifier">FlowLogic</span></a><span class="symbol">&lt;</span><a href="-fetch-data-flow/-result/index.html"><span class="identifier">Result</span></a><span class="symbol">&lt;</span><span class="identifier">T</span><span class="symbol">&gt;</span><span class="symbol">&gt;</span></code>
<p>An abstract flow for fetching typed data from a remote peer.</p>
</td>
</tr>
<tr>
<td>
<p><a href="-fetch-transactions-flow/index.html">FetchTransactionsFlow</a></p>
</td>
<td>
<code><span class="keyword">class </span><span class="identifier">FetchTransactionsFlow</span>&nbsp;<span class="symbol">:</span>&nbsp;<a href="-fetch-data-flow/index.html"><span class="identifier">FetchDataFlow</span></a><span class="symbol">&lt;</span><a href="../net.corda.core.transactions/-signed-transaction/index.html"><span class="identifier">SignedTransaction</span></a><span class="symbol">,</span>&nbsp;<a href="../net.corda.core.transactions/-signed-transaction/index.html"><span class="identifier">SignedTransaction</span></a><span class="symbol">&gt;</span></code>
<p>Given a set of tx hashes (IDs), either loads them from local disk or asks the remote peer to provide them.</p>
</td>
</tr>
<tr>
<td>
<p><a href="-flow-state-machine/index.html">FlowStateMachine</a></p>
</td>
<td>
<code><span class="keyword">interface </span><span class="identifier">FlowStateMachine</span><span class="symbol">&lt;</span><span class="identifier">R</span><span class="symbol">&gt;</span></code>
<p>This is an internal interface that is implemented by code in the node module. You should look at <a href="../net.corda.core.flows/-flow-logic/index.html">FlowLogic</a>.</p>
</td>
</tr>
<tr>
<td>
<p><a href="-input-stream-and-hash/index.html">InputStreamAndHash</a></p>
</td>
<td>
<code><span class="keyword">data</span> <span class="keyword">class </span><span class="identifier">InputStreamAndHash</span></code></td>
</tr>
<tr>
<td>
<p><a href="-lazy-pool/index.html">LazyPool</a></p>
</td>
<td>
<code><span class="keyword">class </span><span class="identifier">LazyPool</span><span class="symbol">&lt;</span><span class="identifier">A</span><span class="symbol">&gt;</span></code>
<p>A lazy pool of resources <a href="#">A</a>.</p>
</td>
</tr>
<tr>
<td>
<p><a href="-lazy-sticky-pool/index.html">LazyStickyPool</a></p>
</td>
<td>
<code><span class="keyword">class </span><span class="identifier">LazyStickyPool</span><span class="symbol">&lt;</span><span class="identifier">A</span>&nbsp;<span class="symbol">:</span>&nbsp;<a href="https://kotlinlang.org/api/latest/jvm/stdlib/kotlin/-any/index.html"><span class="identifier">Any</span></a><span class="symbol">&gt;</span></code>
<p>A <a href="-lazy-sticky-pool/index.html">LazyStickyPool</a> is a lazy pool of resources where a <a href="-lazy-sticky-pool/borrow.html">borrow</a> may "stick" the borrowed instance to an object.
Any subsequent borrows using the same object will return the same pooled instance.</p>
</td>
</tr>
<tr>
<td>
<p><a href="-legal-name-validator/index.html">LegalNameValidator</a></p>
</td>
<td>
<code><span class="keyword">object </span><span class="identifier">LegalNameValidator</span></code></td>
</tr>
<tr>
<td>
<p><a href="-life-cycle/index.html">LifeCycle</a></p>
</td>
<td>
<code><span class="keyword">class </span><span class="identifier">LifeCycle</span><span class="symbol">&lt;</span><span class="identifier">S</span>&nbsp;<span class="symbol">:</span>&nbsp;<a href="https://kotlinlang.org/api/latest/jvm/stdlib/kotlin/-enum/index.html"><span class="identifier">Enum</span></a><span class="symbol">&lt;</span><span class="identifier">S</span><span class="symbol">&gt;</span><span class="symbol">&gt;</span></code>
<p>This class provides simple tracking of the lifecycle of a service-type object.
<a href="#">S</a> is an enum enumerating the possible states the service can be in.</p>
</td>
</tr>
<tr>
<td>
<p><a href="-resolve-transactions-flow/index.html">ResolveTransactionsFlow</a></p>
</td>
<td>
<code><span class="keyword">class </span><span class="identifier">ResolveTransactionsFlow</span>&nbsp;<span class="symbol">:</span>&nbsp;<a href="../net.corda.core.flows/-flow-logic/index.html"><span class="identifier">FlowLogic</span></a><span class="symbol">&lt;</span><a href="https://kotlinlang.org/api/latest/jvm/stdlib/kotlin.collections/-list/index.html"><span class="identifier">List</span></a><span class="symbol">&lt;</span><a href="../net.corda.core.transactions/-signed-transaction/index.html"><span class="identifier">SignedTransaction</span></a><span class="symbol">&gt;</span><span class="symbol">&gt;</span></code>
<p>Resolves transactions for the specified <a href="#">txHashes</a> along with their full history (dependency graph) from <a href="#">otherSide</a>.
Each retrieved transaction is validated and inserted into the local transaction storage.</p>
</td>
</tr>
<tr>
<td>
<p><a href="-thread-box/index.html">ThreadBox</a></p>
</td>
<td>
<code><span class="keyword">class </span><span class="identifier">ThreadBox</span><span class="symbol">&lt;</span><span class="keyword">out</span>&nbsp;<span class="identifier">T</span><span class="symbol">&gt;</span></code>
<p>A threadbox is a simple utility that makes it harder to forget to take a lock before accessing some shared state.
Simply define a private class to hold the data that must be grouped under the same lock, and then pass the only
instance to the ThreadBox constructor. You can now use the <a href="-thread-box/locked.html">locked</a> method with a lambda to take the lock in a
way that ensures it'll be released if there's an exception.</p>
</td>
</tr>
<tr>
<td>
<p><a href="-upgrade-command/index.html">UpgradeCommand</a></p>
</td>
<td>
<code><span class="keyword">data</span> <span class="keyword">class </span><span class="identifier">UpgradeCommand</span>&nbsp;<span class="symbol">:</span>&nbsp;<a href="../net.corda.core.contracts/-command-data.html"><span class="identifier">CommandData</span></a></code>
<p>Indicates that this transaction replaces the inputs contract state to another contract state</p>
</td>
</tr>
<tr>
<td>
<p><a href="-write-once-property/index.html">WriteOnceProperty</a></p>
</td>
<td>
<code><span class="keyword">class </span><span class="identifier">WriteOnceProperty</span><span class="symbol">&lt;</span><span class="identifier">T</span>&nbsp;<span class="symbol">:</span>&nbsp;<a href="https://kotlinlang.org/api/latest/jvm/stdlib/kotlin/-any/index.html"><span class="identifier">Any</span></a><span class="symbol">&gt;</span></code>
<p>A write-once property to be used as delegate for Kotlin var properties.  The expectation is that this is initialised
prior to the spawning of any threads that may access it and so there's no need for it to be volatile.</p>
</td>
</tr>
<tr>
<td>
<p><a href="-x509-ed-d-s-a-engine/index.html">X509EdDSAEngine</a></p>
</td>
<td>
<code><span class="keyword">class </span><span class="identifier">X509EdDSAEngine</span>&nbsp;<span class="symbol">:</span>&nbsp;<span class="identifier">Signature</span></code>
<p>Wrapper around <a href="#">EdDSAEngine</a> which can intelligently rewrite X509Keys to a <a href="#">EdDSAPublicKey</a>. This is a temporary
solution until this is integrated upstream and/or a custom certificate factory implemented to force the correct
key type. Only intercepts public keys passed into <a href="-x509-ed-d-s-a-engine/engine-init-verify.html">engineInitVerify</a>, as there is no equivalent issue with private
keys.</p>
</td>
</tr>
</tbody>
</table>
<h3>Annotations</h3>
<table>
<tbody>
<tr>
<td>
<p><a href="-visible-for-testing/index.html">VisibleForTesting</a></p>
</td>
<td>
<code><span class="keyword">annotation</span> <span class="keyword">class </span><span class="identifier">VisibleForTesting</span></code>
<p>The annotated object would have a more restricted visibility were it not needed in tests.</p>
</td>
</tr>
</tbody>
</table>
<h3>Extensions for External Classes</h3>
<table>
<tbody>
<tr>
<td>
<p><a href="java.io.-byte-array-output-stream/index.html">java.io.ByteArrayOutputStream</a></p>
</td>
<td>
</td>
</tr>
<tr>
<td>
<p><a href="java.io.-input-stream/index.html">java.io.InputStream</a></p>
</td>
<td>
</td>
</tr>
<tr>
<td>
<p><a href="java.lang.-class/index.html">java.lang.Class</a></p>
</td>
<td>
</td>
</tr>
<tr>
<td>
<p><a href="java.nio.file.-path/index.html">java.nio.file.Path</a></p>
</td>
<td>
</td>
</tr>
<tr>
<td>
<p><a href="java.security.cert.-certificate/index.html">java.security.cert.Certificate</a></p>
</td>
<td>
</td>
</tr>
<tr>
<td>
<p><a href="java.time.-duration/index.html">java.time.Duration</a></p>
</td>
<td>
</td>
</tr>
<tr>
<td>
<p><a href="java.time.temporal.-temporal/index.html">java.time.temporal.Temporal</a></p>
</td>
<td>
</td>
</tr>
<tr>
<td>
<p><a href="java.util.jar.-jar-input-stream/index.html">java.util.jar.JarInputStream</a></p>
</td>
<td>
</td>
</tr>
<tr>
<td>
<p><a href="java.util.stream.-stream/index.html">java.util.stream.Stream</a></p>
</td>
<td>
</td>
</tr>
<tr>
<td>
<p><a href="kotlin.-string/index.html">kotlin.String</a></p>
</td>
<td>
</td>
</tr>
<tr>
<td>
<p><a href="kotlin.-throwable/index.html">kotlin.Throwable</a></p>
</td>
<td>
</td>
</tr>
<tr>
<td>
<p><a href="kotlin.collections.-int-iterator/index.html">kotlin.collections.IntIterator</a></p>
</td>
<td>
</td>
</tr>
<tr>
<td>
<p><a href="kotlin.collections.-iterable/index.html">kotlin.collections.Iterable</a></p>
</td>
<td>
</td>
</tr>
<tr>
<td>
<p><a href="kotlin.collections.-list/index.html">kotlin.collections.List</a></p>
</td>
<td>
</td>
</tr>
<tr>
<td>
<p><a href="kotlin.ranges.-int-progression/index.html">kotlin.ranges.IntProgression</a></p>
</td>
<td>
</td>
</tr>
<tr>
<td>
<p><a href="kotlin.reflect.-k-class/index.html">kotlin.reflect.KClass</a></p>
</td>
<td>
</td>
</tr>
<tr>
<td>
<p><a href="org.bouncycastle.asn1.x500.-x500-name/index.html">org.bouncycastle.asn1.x500.X500Name</a></p>
</td>
<td>
</td>
</tr>
<tr>
<td>
<p><a href="org.bouncycastle.cert.-x509-certificate-holder/index.html">org.bouncycastle.cert.X509CertificateHolder</a></p>
</td>
<td>
</td>
</tr>
<tr>
<td>
<p><a href="org.slf4j.-logger/index.html">org.slf4j.Logger</a></p>
</td>
<td>
</td>
</tr>
<tr>
<td>
<p><a href="rx.-observable/index.html">rx.Observable</a></p>
</td>
<td>
</td>
</tr>
<tr>
<td>
<p><a href="rx.-observer/index.html">rx.Observer</a></p>
</td>
<td>
</td>
</tr>
</tbody>
</table>
<h3>Properties</h3>
<table>
<tbody>
<tr>
<td>
<p><a href="country-codes.html">countryCodes</a></p>
</td>
<td>
<code><span class="keyword">val </span><span class="identifier">countryCodes</span><span class="symbol">: </span><a href="https://kotlinlang.org/api/latest/jvm/stdlib/kotlin.collections/-set/index.html"><span class="identifier">Set</span></a><span class="symbol">&lt;</span><a href="https://kotlinlang.org/api/latest/jvm/stdlib/kotlin/-string/index.html"><span class="identifier">String</span></a><span class="symbol">&gt;</span></code></td>
</tr>
<tr>
<td>
<p><a href="x500-name.html">x500Name</a></p>
</td>
<td>
<code><span class="keyword">val </span><a href="../net.corda.core.identity/-corda-x500-name/index.html"><span class="identifier">CordaX500Name</span></a><span class="symbol">.</span><span class="identifier">x500Name</span><span class="symbol">: </span><a href="http://www.bouncycastle.org/docs/docs1.5on/org/bouncycastle/asn1/x500/X500Name.html"><span class="identifier">X500Name</span></a></code>
<p>Return the underlying X.500 name from this Corda-safe X.500 name. These are guaranteed to have a consistent
ordering, such that their <code>toString()</code> function returns the same value every time for the same <a href="../net.corda.core.identity/-corda-x500-name/index.html">CordaX500Name</a>.</p>
</td>
</tr>
</tbody>
</table>
<h3>Functions</h3>
<table>
<tbody>
<tr>
<td>
<p><a href="elapsed-time.html">elapsedTime</a></p>
</td>
<td>
<code><span class="keyword">fun </span><span class="identifier">elapsedTime</span><span class="symbol">(</span><span class="identifier" id="net.corda.core.internal$elapsedTime(kotlin.Function0((kotlin.Unit)))/block">block</span><span class="symbol">:</span>&nbsp;<span class="symbol">(</span><span class="symbol">)</span>&nbsp;<span class="symbol">-&gt;</span>&nbsp;<a href="https://kotlinlang.org/api/latest/jvm/stdlib/kotlin/-unit/index.html"><span class="identifier">Unit</span></a><span class="symbol">)</span><span class="symbol">: </span><span class="identifier">Duration</span></code>
<p>Executes the given code block and returns a <a href="#">Duration</a> of how long it took to execute in nanosecond precision.</p>
</td>
</tr>
<tr>
<td>
<p><a href="log-elapsed-time.html">logElapsedTime</a></p>
</td>
<td>
<code><span class="keyword">fun </span><span class="symbol">&lt;</span><span class="identifier">T</span><span class="symbol">&gt;</span> <span class="identifier">logElapsedTime</span><span class="symbol">(</span><span class="identifier" id="net.corda.core.internal$logElapsedTime(kotlin.String, org.slf4j.Logger, kotlin.Function0((net.corda.core.internal.logElapsedTime.T)))/label">label</span><span class="symbol">:</span>&nbsp;<a href="https://kotlinlang.org/api/latest/jvm/stdlib/kotlin/-string/index.html"><span class="identifier">String</span></a><span class="symbol">, </span><span class="identifier" id="net.corda.core.internal$logElapsedTime(kotlin.String, org.slf4j.Logger, kotlin.Function0((net.corda.core.internal.logElapsedTime.T)))/logger">logger</span><span class="symbol">:</span>&nbsp;<span class="identifier">Logger</span><span class="symbol">?</span>&nbsp;<span class="symbol">=</span>&nbsp;null<span class="symbol">, </span><span class="identifier" id="net.corda.core.internal$logElapsedTime(kotlin.String, org.slf4j.Logger, kotlin.Function0((net.corda.core.internal.logElapsedTime.T)))/body">body</span><span class="symbol">:</span>&nbsp;<span class="symbol">(</span><span class="symbol">)</span>&nbsp;<span class="symbol">-&gt;</span>&nbsp;<span class="identifier">T</span><span class="symbol">)</span><span class="symbol">: </span><span class="identifier">T</span></code></td>
</tr>
<tr>
<td>
<p><a href="unchecked-cast.html">uncheckedCast</a></p>
</td>
<td>
<code><span class="keyword">fun </span><span class="symbol">&lt;</span><span class="identifier">T</span><span class="symbol">, </span><span class="identifier">U</span>&nbsp;<span class="symbol">:</span>&nbsp;<span class="identifier">T</span><span class="symbol">&gt;</span> <span class="identifier">uncheckedCast</span><span class="symbol">(</span><span class="identifier" id="net.corda.core.internal$uncheckedCast(net.corda.core.internal.uncheckedCast.T)/obj">obj</span><span class="symbol">:</span>&nbsp;<span class="identifier">T</span><span class="symbol">)</span><span class="symbol">: </span><span class="identifier">U</span></code></td>
</tr>
</tbody>
</table>

<style>
    @import url("https://fonts.googleapis.com/css?family=Source+Sans+Pro:300,400,500,600");
    #cookies-eu-banner {
        background-color: rgba(83, 88, 95, 0.9);
        border-radius: 3px;
        color: #fff;
        font-family: 'Source Sans Pro', sans-serif;
        font-size: 13px;
        font-weight: 400;
        left: 3px;
        position: fixed;
        padding: 6px;
        right: 3px;
        text-align: center;
        top: 100px;
        z-index: 1000;
    }
    
    #cookies-eu-banner h3,
    #cookies-eu-banner p {
        color: #fff;
        font-size: 18px;
        letter-spacing: 0;
    }
    
    #cookies-eu-banner h3 {
        font-size: 24px;
        font-style: normal;
        font-weight: 400;
        line-height: 1.2;
        margin: 9px 0 0;
        text-transform: uppercase;
    }
    
    #cookies-eu-banner p {
        margin-bottom: 10px;
        padding: 8px 36px 0;
        text-align: justify;
        line-height: 1.4em;
    }
    
    #cookies-eu-banner fieldset {
        min-width: 0;
        padding: 0;
        margin: 0;
        border: 0;
    }
    
    #cookies-eu-banner legend {
        color: inherit;
        display: block;
        font-size: 18px;
        line-height: inherit;
        max-width: 100%;
        margin-bottom: 16px;
        padding: 0;
        white-space: normal;
        width: 100%;
    }
    
    #cookies-eu-banner a {
        color: #62AAF1;
    }
    
    #cookies-eu-banner .cookies-button-group {
        display: flex;
        justify-content: center;
    }
    
    #cookies-eu-accept,
    #cookies-eu-accept-all {
        background-color: #ec1d24;
        border: none;
        border-radius: 6px;
        color: #fff;
        font-size: 12px;
        font-weight: 600;
        margin: 0 10px 10px;
        max-height: 40px;
        height: 40px;
        line-height: 1.1;
        text-decoration: none;
        width: 150px;
    }
    
    .cookies-checkbox {
        display: inline-block;
        margin: 5px 10px;
    }
    
    .cookies-checkbox label {
        font-size: 16px;
        margin-left: 3px;
    }
    
    @media screen and (min-width: 768px) {
        #cookies-eu-banner {
            bottom: 5px;
            top: inherit;
        }
        #cookies-eu-accept,
        #cookies-eu-accept-all {
            font-size: 14px;
        }
    }
</style>
<div id="cookies-eu-banner" style="display: none;">
    <h3 style="text-transform:none">Your privacy</h3>
    <div class='cookie-flex'>
        <p>
            We use cookies to improve your experience on our site, and to help us understand how people use our documentation. For more detailed information, see our <a href="https://www.r3.com/privacy-policy/">privacy policy</a> and <a href="#">cookie declaration</a>.
        </p>
        <form id='cookie-consent-form'>
            <fieldset>
                <legend>
                    Please select from the following options to continue to our site.
                </legend>
                <div class='cookies-button-group'>
                    <button id="cookies-eu-accept" type="button">
                      Allow cookies selected
                    </button>
                    <button id="cookies-eu-accept-all" type="button">
                      Allow all cookies
                    </button>
                    <span class='cookies-checkbox'>
                      <input
                      type="checkbox"
                      id="necessary"
                      name="necessary"
                      autocomplete="off"
                      checked
                      disabled />
                        <input
                        name="necessary"
                        type="hidden"
                        value="on"/>
                        <label for="necessary">Necessary</label>
                    </span>
                    <span class='cookies-checkbox'>
                      <input
                      type="checkbox"
                      id="preferences"
                      name="preferences"
                      autocomplete="off" />
                      <label for="preferences">Preferences</label>
                    </span>
                    <span class='cookies-checkbox'>
                      <input
                      type="checkbox"
                      id="statistics"
                      name="statistics"
                      autocomplete="off" />
                      <label for="statistics">Statistics</label>
                    </span>
                    <span class='cookies-checkbox'>
                      <input
                      type="checkbox"
                      id="marketing"
                      name="marketing"
                      autocomplete="off" />
                      <label for="marketing">Marketing</label>
                    </span>
                </div>
            </fieldset>
        </form>
    </div>
</div>
<script class='api-keys'>
    var gaKey = 'UA-87760032-1';
    var algolia_appId = "UX2KMUWFAL";
    var algolia_apiKey = "1fe3367db02689b4aeebc59efad5abaf";
    var algolia_index = "docs.corda.net";
</script>
<script class='cookies-eu-banner'>
    ! function(root, factory) {
        "use strict";
        "function" == typeof define && define.amd ? define([], factory) : "object" == typeof exports ? module.exports = factory() : root.CookiesEuBanner = factory()
    }(window, function() {
        "use strict";
        var document = window.document,
            CookiesEuBanner = function(launchFunction, waitAccept, useLocalStorage, undefined) {
                if (!(this instanceof CookiesEuBanner)) return new CookiesEuBanner(launchFunction);
                this.cookieTimeout = 33696e6, this.bots = /bot|crawler|spider|crawling/i, this.cookieName = "hasConsent", this.trackingCookiesNames = ["__utma", "__utmb", "__utmc", "__utmt", "__utmv", "__utmz", "_ga", "_gat", "_gid"], this.launchFunction = launchFunction, this.waitAccept = waitAccept || !1, this.useLocalStorage = useLocalStorage || !1, this.init()
            };
        return CookiesEuBanner.prototype = {
            init: function() {
                var isBot = this.bots.test(navigator.userAgent);
                navigator.doNotTrack || navigator.msDoNotTrack || window.doNotTrack;
                return isBot || !1 === this.hasConsent() ? (this.removeBanner(0), !1) : !0 === this.hasConsent() ? (this.launchFunction(), !0) : (this.showBanner(), void(this.waitAccept || this.setConsent(!0)))
            },
            showBanner: function() {
                var _this = this,
                    getElementById = document.getElementById.bind(document),
                    banner = getElementById("cookies-eu-banner"),
                    rejectButton = getElementById("cookies-eu-reject"),
                    acceptButton = getElementById("cookies-eu-accept"),
                    moreLink = getElementById("cookies-eu-more"),
                    waitRemove = void 0 === banner.dataset.waitRemove ? 0 : parseInt(banner.dataset.waitRemove),
                    addClickListener = this.addClickListener,
                    removeBanner = _this.removeBanner.bind(_this, waitRemove);
                banner.style.display = "block", moreLink && addClickListener(moreLink, function() {
                    _this.deleteCookie(_this.cookieName)
                }), acceptButton && addClickListener(acceptButton, function() {
                    removeBanner(), _this.setConsent(!0), _this.launchFunction()
                }), rejectButton && addClickListener(rejectButton, function() {
                    removeBanner(), _this.setConsent(!1), _this.trackingCookiesNames.map(_this.deleteCookie)
                })
            },
            setConsent: function(consent) {
                if (this.useLocalStorage) return localStorage.setItem(this.cookieName, consent);
                this.setCookie(this.cookieName, consent)
            },
            hasConsent: function() {
                function isCookieSetTo(value) {
                    return -1 < document.cookie.indexOf(cookieName + "=" + value) || localStorage.getItem(cookieName) === value
                }
                var cookieName = this.cookieName;
                return !!isCookieSetTo("true") || !isCookieSetTo("false") && null
            },
            setCookie: function(name, value) {
                var date = new Date;
                date.setTime(date.getTime() + this.cookieTimeout), document.cookie = name + "=" + value + ";SameSite=Strict;expires=" + date.toGMTString() + ";path=/"
            },
            deleteCookie: function(name) {
                var hostname = document.location.hostname.replace(/^www\./, ""),
                    commonSuffix = "; expires=Thu, 01-Jan-1970 00:00:01 GMT; path=/";
                document.cookie = name + "=; domain=." + hostname + commonSuffix, document.cookie = name + "=" + commonSuffix
            },
            addClickListener: function(DOMElement, callback) {
                if (DOMElement.attachEvent) return DOMElement.attachEvent("onclick", callback);
                DOMElement.addEventListener("click", callback)
            },
            removeBanner: function(wait) {
                setTimeout(function() {
                    var banner = document.getElementById("cookies-eu-banner");
                    banner && banner.parentNode && banner.parentNode.removeChild(banner)
                }, wait)
            }
        }, CookiesEuBanner
    });
</script>
<script class='google-analytics'>
    function googleAnalytics() {
        var i, s, o, r, a, m;
        i = window, s = document, o = "script", r = "ga", i.GoogleAnalyticsObject = r, i.ga = i.ga || function() {
            (i.ga.q = i.ga.q || []).push(arguments)
        }, i.ga.l = +new Date, a = s.createElement(o), m = s.getElementsByTagName(o)[0], a.async = 1, a.src = "//www.google-analytics.com/analytics.js", m.parentNode.insertBefore(a, m), window.ga("create", "UA-87760032-1", "auto"), window.ga("send", "pageview")
    }
</script>
<script class='docSearchInit'>
    function docSearchInit() {
        var algoliaOptions;
        document.querySelector("#search-input") && (algoliaOptions = {
            hitsPerPage: 5,
            facetFilters: facetFilters
        }, /404.html/.test(window.location.pathname) && delete algoliaOptions.facetFilters, window.docsearch({
            appId: algolia_appId,
            apiKey: algolia_apiKey,
            indexName: algolia_index,
            inputSelector: "#search-input",
            algoliaOptions: algoliaOptions
        }))
    }
</script>
<script class='corda-cookie-banner'>
    const docsearchLoad = (resolve, reject) => {
        const script = document.createElement('script');
        document.body.appendChild(script);
        script.onload = resolve;
        script.onerror = reject;
        script.async = true;
        script.src = "https://cdn.jsdelivr.net/npm/docsearch.js@2.6.3/dist/cdn/docsearch.min.js";
    };

    class DocsiteCookies {
        constructor() {
            this.name = 'corda_cookie';
            this.cookiesAccepted = {
                set: true,
                necessary: true,
                preferences: false,
                statistics: false,
                marketing: false
            };
            this.form = document.querySelector('#cookie-consent-form');
            this.handleAllCookies();

            new CookiesEuBanner(() => {
                this.cookieBanner();
            }, true);
        }

        handleAllCookies() {
            const acceptButton = document.querySelector('#cookies-eu-accept');
            const allCookiesButton = document.querySelector('#cookies-eu-accept-all');

            allCookiesButton.addEventListener('click', e => {
                e.preventDefault();
                this.allowAllCookies(this.form);
                acceptButton.click();
            });
        }

        cookieBanner() {
            if (!this.checkConsent()) {
                this.formToCookie(this.name, this.form);
                this.setAdditionalServices();
            } else {
                this.setAdditionalServices();
            }
        }

        allowAllCookies(form) {
            let cookiePreferences = form.querySelectorAll('.cookies-checkbox');
            for (let cookie of cookiePreferences) {
                cookie.querySelector('input').checked = true;
            }
        }

        formToCookie(name, form) {
            const thirteenMonthsInMils = 31104000000;

            let date = new Date();
            date.setTime(date.getTime() + thirteenMonthsInMils);

            let formData = new FormData(form);
            for (var pair of formData.entries()) {
                switch (pair[0]) {
                    case "necessary":
                        this.cookiesAccepted.necessary = (pair[1] === 'on') ?
                            true :
                            false;
                        break;
                    case "preferences":
                        this.cookiesAccepted.preferences = (pair[1] === 'on') ?
                            true :
                            false;
                        break;
                    case "statistics":
                        this.cookiesAccepted.statistics = (pair[1] === 'on') ?
                            true :
                            false;
                        break;
                    case "marketing":
                        this.cookiesAccepted.marketing = (pair[1] === 'on') ?
                            true :
                            false;
                        break;
                    default:
                        break;
                }
            }
            let cookieValue = JSON.stringify(this.cookiesAccepted);

            document.cookie = `${name}=${cookieValue};SameSite=Strict;expires=${date.toGMTString()};path=/`;
        }

        checkConsent() {
            let cookieName = this.name;
            let cookieValue = this.getCookie(cookieName);

            if (cookieValue) {
                if (cookieValue.set === true) {
                    return true;
                } else {
                    return false;
                }
            } else {
                return false;
            }
        }

        getCookie(name) {
            let value = "; " + document.cookie;
            let parts = value.split("; " + name + "=");
            let cValue = "";

            if (parts.length == 2) {
                cValue = parts.pop().split(";").shift();
            }

            if (hasJsonStructure(cValue)) {
                return JSON.parse(cValue);
            } else {
                return cValue;
            }
        }

        setAdditionalServices() {
            let cookieConsent = this.getCookie(this.name);
            for (let [key, value] of Object.entries(cookieConsent)) {
                if (key === 'necessary' && value === true) {
                    new Promise(docsearchLoad)
                        .then(() => {
                            docSearchInit();
                        })
                        .catch(err => console.log(err));
                }
                if (key === 'statistics' && value === true) {
                    googleAnalytics();
                }
            }
        }
    }

    function hasJsonStructure(str) {
        if (typeof str !== 'string') return false;
        try {
            const result = JSON.parse(str);
            const type = Object.prototype.toString.call(result);
            return type === '[object Object]' ||
                type === '[object Array]';
        } catch (err) {
            return false;
        }
    }
</script>
<script class='initialise'>
    new DocsiteCookies();
</script>
</body>
</HTML>
