{{/* Initial read of descriptions from Corda JSON config files using the new GetRemote + Unmarshal method */}}
{{ with $.Params.url }}
    {{ $remote := resources.GetRemote . }}
    {{ with $remote }}
        {{ $json := . | transform.Unmarshal }}

        <p>{{ $json.description }}</p>

        {{ range $key, $value := $json.properties }}
            {{ with $value }}
                <ul>
                    {{ partial "field-desc-ref-docs" (dict "value" $value "key" $key "url" $.Params.url) }}
                    <ul>
                        {{/* Second-level properties */}}
                        {{ range $childk, $childv := $value.properties }}
                            {{ with $childv }}
                                {{ partial "field-desc-ref-docs" (dict "value" $childv "key" $childk "url" $.Params.url) }}

                                {{/* Third-level properties */}}
                                {{ range $childk2, $childv2 := $childv.properties }}
                                    {{ with $childv2 }}
                                        <ul>
                                            {{ partial "field-desc-ref-docs" (dict "value" $childv2 "key" $childk2 "url" $.Params.url) }}
                                        </ul>
                                    {{ end }}
                                {{ end }}
                            {{ end }}
                        {{ end }}

                        {{/* Top-level conditional values inside each property */}}
                        {{ with $value.allOf }}
                            {{ partial "conditional-field-desc-ref-docs" (dict "value" $value "url" $.Params.url) }}
                        {{ end }}
                    </ul>
                </ul>
            {{ end }}
        {{ end }}

        {{/* Top-level conditional values */}}
        {{ with $json.allOf }}
            {{ partial "conditional-field-desc-ref-docs" (dict "value" $json "url" $.Params.url) }}
        {{ end }}

    {{ else }}
        <p>Error: Could not load remote JSON from {{ $.Params.url }}</p>
    {{ end }}
{{ else }}
    <p>Error: No URL provided to the shortcode.</p>
{{ end }}

