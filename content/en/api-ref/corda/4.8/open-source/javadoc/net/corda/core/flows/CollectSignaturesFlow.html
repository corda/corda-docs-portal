<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<!-- NewPage -->
<html lang="en">
<head>
<!-- Generated by javadoc (1.8.0_265) on Fri Apr 23 17:46:40 BST 2021 -->
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<title>CollectSignaturesFlow</title>
<meta name="date" content="2021-04-23">
<meta name="keywords" content="net.corda.core.flows.CollectSignaturesFlow class">
<meta name="keywords" content="Companion">
<meta name="keywords" content="call()">
<meta name="keywords" content="getPartiallySignedTx()">
<meta name="keywords" content="getSessionsToCollectFrom()">
<meta name="keywords" content="getMyOptionalKeys()">
<meta name="keywords" content="getProgressTracker()">
<link rel="stylesheet" type="text/css" href="../../../../stylesheet.css" title="Style">
<script type="text/javascript" src="../../../../script.js"></script>
</head>
<body>
<script type="text/javascript"><!--
    try {
        if (location.href.indexOf('is-external=true') == -1) {
            parent.document.title="CollectSignaturesFlow";
        }
    }
    catch(err) {
    }
//-->
var methods = {"i0":10,"i1":10,"i2":10,"i3":10,"i4":10};
var tabs = {65535:["t0","All Methods"],2:["t2","Instance Methods"],8:["t4","Concrete Methods"]};
var altColor = "altColor";
var rowColor = "rowColor";
var tableTab = "tableTab";
var activeTableTab = "activeTableTab";
</script>
<noscript>
<div>JavaScript is disabled on your browser.</div>
</noscript>
<!-- ========= START OF TOP NAVBAR ======= -->
<div class="topNav"><a name="navbar.top">
<!--   -->
</a>
<div class="skipNav"><a href="#skip.navbar.top" title="Skip navigation links">Skip navigation links</a></div>
<a name="navbar.top.firstrow">
<!--   -->
</a>
<ul class="navList" title="Navigation">
<li><a href="../../../../overview-summary.html">Overview</a></li>
<li><a href="package-summary.html">Package</a></li>
<li class="navBarCell1Rev">Class</li>
<li><a href="package-tree.html">Tree</a></li>
<li><a href="../../../../deprecated-list.html">Deprecated</a></li>
<li><a href="../../../../index-all.html">Index</a></li>
<li><a href="../../../../help-doc.html">Help</a></li>
</ul>
</div>
<div class="subNav">
<ul class="navList">
<li><a href="../../../../net/corda/core/flows/CollectSignatureFlow.html" title="class in net.corda.core.flows"><span class="typeNameLink">Prev&nbsp;Class</span></a></li>
<li><a href="../../../../net/corda/core/flows/TimeWindowInvalid.Companion.html" title="class in net.corda.core.flows"><span class="typeNameLink">Next&nbsp;Class</span></a></li>
</ul>
<ul class="navList">
<li><a href="../../../../index.html?net/corda/core/flows/CollectSignaturesFlow.html" target="_top">Frames</a></li>
<li><a href="CollectSignaturesFlow.html" target="_top">No&nbsp;Frames</a></li>
</ul>
<ul class="navList" id="allclasses_navbar_top">
<li><a href="../../../../allclasses-noframe.html">All&nbsp;Classes</a></li>
</ul>
<div>
<script type="text/javascript"><!--
  allClassesLink = document.getElementById("allclasses_navbar_top");
  if(window==top) {
    allClassesLink.style.display = "block";
  }
  else {
    allClassesLink.style.display = "none";
  }
  //-->
</script>
</div>
<div>
<ul class="subNavList">
<li>Summary:&nbsp;</li>
<li><a href="#nested.class.summary">Nested</a>&nbsp;|&nbsp;</li>
<li><a href="#field.summary">Field</a>&nbsp;|&nbsp;</li>
<li><a href="#constructor.summary">Constr</a>&nbsp;|&nbsp;</li>
<li><a href="#method.summary">Method</a></li>
</ul>
<ul class="subNavList">
<li>Detail:&nbsp;</li>
<li><a href="#field.detail">Field</a>&nbsp;|&nbsp;</li>
<li><a href="#constructor.detail">Constr</a>&nbsp;|&nbsp;</li>
<li><a href="#method.detail">Method</a></li>
</ul>
</div>
<a name="skip.navbar.top">
<!--   -->
</a></div>
<!-- ========= END OF TOP NAVBAR ========= -->
<!-- ======== START OF CLASS DATA ======== -->
<div class="header">
<div class="subTitle">net.corda.core.flows</div>
<h2 title="Class CollectSignaturesFlow" class="title">Class CollectSignaturesFlow</h2>
</div>
<div class="contentContainer">
<ul class="inheritance">
<li><a href="../../../../net/corda/core/flows/FlowLogic.html" title="class in net.corda.core.flows">net.corda.core.flows.FlowLogic</a>&lt;T&gt;</li>
<li>
<ul class="inheritance">
<li>net.corda.core.flows.CollectSignaturesFlow</li>
</ul>
</li>
</ul>
<div class="description">
<ul class="blockList">
<li class="blockList">
<hr>
<br>
<pre>public class <span class="typeNameLabel">CollectSignaturesFlow</span>
extends <a href="../../../../net/corda/core/flows/FlowLogic.html" title="class in net.corda.core.flows">FlowLogic</a>&lt;T&gt;</pre>
<div class="block"><p><p>The <a href="../../../../net/corda/core/flows/CollectSignaturesFlow.html" title="class in net.corda.core.flows"><code>class CollectSignaturesFlow</code></a> is used to automate the collection of counterparty signatures for a given transaction.</p></p><p><p><p>You would typically use this flow after you have built a transaction with the TransactionBuilder and signed it with
your key pair. If there are additional signatures to collect then they can be collected using this flow. Signatures
are collected based upon the <a href="../../../../net/corda/core/transactions/WireTransaction.html#getRequiredSigningKeys--"><code>WireTransaction.getRequiredSigningKeys</code></a> property which contains the union of all the PublicKeys
listed in the transaction's commands as well as a notary's public key, if required. This flow returns a
<a href="../../../../net/corda/core/transactions/SignedTransaction.html" title="class in net.corda.core.transactions"><code>class SignedTransaction</code></a> which can then be passed to the <a href="../../../../net/corda/core/flows/FinalityFlow.html" title="class in net.corda.core.flows"><code>class FinalityFlow</code></a> for notarisation. The other side of this flow is
the <a href="../../../../net/corda/core/flows/SignTransactionFlow.html" title="class in net.corda.core.flows"><code>class SignTransactionFlow</code></a>.</p><p><strong>WARNING</strong>: This flow ONLY works with ServiceHub.legalIdentityKeys and WILL break if used with randomly generated
keys by the <a href="../../../../net/corda/core/node/ServiceHub.html#getKeyManagementService--"><code>ServiceHub.getKeyManagementService</code></a>.</p><p>Usage:</p><ul><li><p>Call the <a href="../../../../net/corda/core/flows/CollectSignaturesFlow.html" title="class in net.corda.core.flows"><code>class CollectSignaturesFlow</code></a> flow as a <a href="../../../../net/corda/core/flows/FlowLogic.html#subFlow-subLogic-"><code>FlowLogic.subFlow</code></a> and pass it a <a href="../../../../net/corda/core/transactions/SignedTransaction.html" title="class in net.corda.core.transactions"><code>class SignedTransaction</code></a> which has at least been
signed by the transaction creator (and possibly an oracle, if required)</p></li><li><p>The flow expects that the calling node has signed the provided transaction, if not the flow will fail</p></li><li><p>The flow will also fail if:</p></li></ul><ol><li><p>The provided transaction is invalid</p></li><li><p>Any of the required signing parties cannot be found in the <a href="../../../../net/corda/core/node/ServiceHub.html#getNetworkMapCache--"><code>ServiceHub.getNetworkMapCache</code></a> of the initiator</p></li><li><p>If the wrong key has been used by a counterparty to sign the transaction</p></li><li><p>The counterparty rejects the provided transaction</p></li></ol><ul><li><p>The flow will return a <a href="../../../../net/corda/core/transactions/SignedTransaction.html" title="class in net.corda.core.transactions"><code>class SignedTransaction</code></a> with all the counterparty signatures (but not the notary's!)</p></li><li><p>If the provided transaction has already been signed by all counterparties then this flow simply returns the
provided transaction without contacting any counterparties</p></li><li><p>Call the <a href="../../../../net/corda/core/flows/FinalityFlow.html" title="class in net.corda.core.flows"><code>class FinalityFlow</code></a> with the return value of this flow</p></li></ul><p>Example - issuing a multi-lateral agreement which requires N signatures:</p><code><pre>    val builder = TransactionBuilder(notaryRef)
    val issueCommand = Command(Agreement.Commands.Issue(), state.participants)

    builder.withItems(state, issueCommand)
    builder.toWireTransaction().toLedgerTransaction(serviceHub).verify()

    // Transaction creator signs transaction.
    val ptx = serviceHub.signInitialTransaction(builder)

    // Call to CollectSignaturesFlow.
    // The returned signed transaction will have all signatures appended apart from the notary's.
    val stx = subFlow(CollectSignaturesFlow(ptx))</pre></code></p></p></div>
<dl>
<dt><span class="seeLabel">See Also:</span></dt>
<dd><a href="../../../../net/corda/core/flows/CollectSignaturesFlow.html" title="class in net.corda.core.flows"><code>class CollectSignaturesFlow</code></a>, 
<a href="../../../../net/corda/core/transactions/WireTransaction.html#getRequiredSigningKeys--"><code>WireTransaction.getRequiredSigningKeys</code></a>, 
<a href="../../../../net/corda/core/transactions/SignedTransaction.html" title="class in net.corda.core.transactions"><code>class SignedTransaction</code></a>, 
<a href="../../../../net/corda/core/flows/FinalityFlow.html" title="class in net.corda.core.flows"><code>class FinalityFlow</code></a>, 
<a href="../../../../net/corda/core/flows/SignTransactionFlow.html" title="class in net.corda.core.flows"><code>class SignTransactionFlow</code></a>, 
<a href="../../../../net/corda/core/node/ServiceHub.html#getKeyManagementService--"><code>ServiceHub.getKeyManagementService</code></a>, 
<a href="../../../../net/corda/core/flows/CollectSignaturesFlow.html" title="class in net.corda.core.flows"><code>class CollectSignaturesFlow</code></a>, 
<a href="../../../../net/corda/core/flows/FlowLogic.html#subFlow-subLogic-"><code>FlowLogic.subFlow</code></a>, 
<a href="../../../../net/corda/core/transactions/SignedTransaction.html" title="class in net.corda.core.transactions"><code>class SignedTransaction</code></a>, 
<a href="../../../../net/corda/core/node/ServiceHub.html#getNetworkMapCache--"><code>ServiceHub.getNetworkMapCache</code></a>, 
<a href="../../../../net/corda/core/transactions/SignedTransaction.html" title="class in net.corda.core.transactions"><code>class SignedTransaction</code></a>, 
<a href="../../../../net/corda/core/flows/FinalityFlow.html" title="class in net.corda.core.flows"><code>class FinalityFlow</code></a></dd>
</dl>
</li>
</ul>
</div>
<div class="summary">
<ul class="blockList">
<li class="blockList">
<!-- ======== NESTED CLASS SUMMARY ======== -->
<ul class="blockList">
<li class="blockList"><a name="nested.class.summary">
<!--   -->
</a>
<h3>Nested Class Summary</h3>
<table class="memberSummary" border="0" cellpadding="3" cellspacing="0" summary="Nested Class Summary table, listing nested classes, and an explanation">
<caption><span>Nested Classes</span><span class="tabEnd">&nbsp;</span></caption>
<tr>
<th class="colFirst" scope="col">Modifier and Type</th>
<th class="colLast" scope="col">Class and Description</th>
</tr>
<tr class="altColor">
<td class="colFirst"><code>static class&nbsp;</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../../net/corda/core/flows/CollectSignaturesFlow.Companion.html" title="class in net.corda.core.flows">CollectSignaturesFlow.Companion</a></span></code>&nbsp;</td>
</tr>
</table>
</li>
</ul>
<!-- =========== FIELD SUMMARY =========== -->
<ul class="blockList">
<li class="blockList"><a name="field.summary">
<!--   -->
</a>
<h3>Field Summary</h3>
<table class="memberSummary" border="0" cellpadding="3" cellspacing="0" summary="Field Summary table, listing fields, and an explanation">
<caption><span>Fields</span><span class="tabEnd">&nbsp;</span></caption>
<tr>
<th class="colFirst" scope="col">Modifier and Type</th>
<th class="colLast" scope="col">Field and Description</th>
</tr>
<tr class="altColor">
<td class="colFirst"><code>static <a href="../../../../net/corda/core/flows/CollectSignaturesFlow.Companion.html" title="type parameter in CollectSignaturesFlow.Companion">CollectSignaturesFlow.Companion</a></code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../../net/corda/core/flows/CollectSignaturesFlow.html#Companion">Companion</a></span></code>&nbsp;</td>
</tr>
</table>
</li>
</ul>
<!-- ======== CONSTRUCTOR SUMMARY ======== -->
<ul class="blockList">
<li class="blockList"><a name="constructor.summary">
<!--   -->
</a>
<h3>Constructor Summary</h3>
<table class="memberSummary" border="0" cellpadding="3" cellspacing="0" summary="Constructor Summary table, listing constructors, and an explanation">
<caption><span>Constructors</span><span class="tabEnd">&nbsp;</span></caption>
<tr>
<th class="colOne" scope="col">Constructor and Description</th>
</tr>
<tr class="altColor">
<td class="colOne"><code><span class="memberNameLink"><a href="../../../../net/corda/core/flows/CollectSignaturesFlow.html#CollectSignaturesFlow-partiallySignedTx-sessionsToCollectFrom-myOptionalKeys-progressTracker-">CollectSignaturesFlow</a></span>(<a href="../../../../net/corda/core/transactions/SignedTransaction.html" title="type parameter in SignedTransaction">SignedTransaction</a>&nbsp;partiallySignedTx,
                     java.util.Collection&lt;? extends net.corda.core.flows.FlowSession&gt;&nbsp;sessionsToCollectFrom,
                     java.lang.Iterable&lt;? extends java.security.PublicKey&gt;&nbsp;myOptionalKeys,
                     <a href="../../../../net/corda/core/utilities/ProgressTracker.html" title="type parameter in ProgressTracker">ProgressTracker</a>&nbsp;progressTracker)</code>
<div class="block">The <a href="../../../../net/corda/core/flows/CollectSignaturesFlow.html" title="class in net.corda.core.flows"><code>class CollectSignaturesFlow</code></a> is used to automate the collection of counterparty signatures for a given transaction.</div>
</td>
</tr>
<tr class="rowColor">
<td class="colOne"><code><span class="memberNameLink"><a href="../../../../net/corda/core/flows/CollectSignaturesFlow.html#CollectSignaturesFlow-partiallySignedTx-sessionsToCollectFrom-progressTracker-">CollectSignaturesFlow</a></span>(<a href="../../../../net/corda/core/transactions/SignedTransaction.html" title="type parameter in SignedTransaction">SignedTransaction</a>&nbsp;partiallySignedTx,
                     java.util.Collection&lt;? extends net.corda.core.flows.FlowSession&gt;&nbsp;sessionsToCollectFrom,
                     <a href="../../../../net/corda/core/utilities/ProgressTracker.html" title="type parameter in ProgressTracker">ProgressTracker</a>&nbsp;progressTracker)</code>&nbsp;</td>
</tr>
</table>
</li>
</ul>
<!-- ========== METHOD SUMMARY =========== -->
<ul class="blockList">
<li class="blockList"><a name="method.summary">
<!--   -->
</a>
<h3>Method Summary</h3>
<table class="memberSummary" border="0" cellpadding="3" cellspacing="0" summary="Method Summary table, listing methods, and an explanation">
<caption><span id="t0" class="activeTableTab"><span>All Methods</span><span class="tabEnd">&nbsp;</span></span><span id="t2" class="tableTab"><span><a href="javascript:show(2);">Instance Methods</a></span><span class="tabEnd">&nbsp;</span></span><span id="t4" class="tableTab"><span><a href="javascript:show(8);">Concrete Methods</a></span><span class="tabEnd">&nbsp;</span></span></caption>
<tr>
<th class="colFirst" scope="col">Modifier and Type</th>
<th class="colLast" scope="col">Method and Description</th>
</tr>
<tr id="i0" class="altColor">
<td class="colFirst"><code><a href="../../../../net/corda/core/transactions/SignedTransaction.html" title="type parameter in SignedTransaction">SignedTransaction</a></code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../../net/corda/core/flows/CollectSignaturesFlow.html#call--">call</a></span>()</code>
<div class="block">This is where you fill out your business logic.</div>
</td>
</tr>
<tr id="i1" class="rowColor">
<td class="colFirst"><code>java.lang.Iterable&lt;java.security.PublicKey&gt;</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../../net/corda/core/flows/CollectSignaturesFlow.html#getMyOptionalKeys--">getMyOptionalKeys</a></span>()</code>
<div class="block">set of keys in the transaction which are owned by this node.</div>
</td>
</tr>
<tr id="i2" class="altColor">
<td class="colFirst"><code><a href="../../../../net/corda/core/transactions/SignedTransaction.html" title="type parameter in SignedTransaction">SignedTransaction</a></code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../../net/corda/core/flows/CollectSignaturesFlow.html#getPartiallySignedTx--">getPartiallySignedTx</a></span>()</code>
<div class="block">Transaction to collect the remaining signatures for</div>
</td>
</tr>
<tr id="i3" class="rowColor">
<td class="colFirst"><code><a href="../../../../net/corda/core/utilities/ProgressTracker.html" title="type parameter in ProgressTracker">ProgressTracker</a></code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../../net/corda/core/flows/CollectSignaturesFlow.html#getProgressTracker--">getProgressTracker</a></span>()</code>
<div class="block">Override this to provide a <a href="../../../../net/corda/core/utilities/ProgressTracker.html" title="class in net.corda.core.utilities"><code>class ProgressTracker</code></a>. If one is provided and stepped, the framework will do something
helpful with the progress reports e.g record to the audit service. If this flow is invoked as a subflow of another,
then the tracker will be made a child of the current step in the parent. If it's null, this flow doesn't track
progress.</div>
</td>
</tr>
<tr id="i4" class="altColor">
<td class="colFirst"><code>java.util.Collection&lt;net.corda.core.flows.FlowSession&gt;</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../../net/corda/core/flows/CollectSignaturesFlow.html#getSessionsToCollectFrom--">getSessionsToCollectFrom</a></span>()</code>
<div class="block">A session for every party we need to collect a signature from.</div>
</td>
</tr>
</table>
<ul class="blockList">
<li class="blockList"><a name="methods.inherited.from.class.net.corda.core.flows.FlowLogic">
<!--   -->
</a>
<h3>Methods inherited from class&nbsp;net.corda.core.flows.<a href="../../../../net/corda/core/flows/FlowLogic.html" title="class in net.corda.core.flows">FlowLogic</a></h3>
<code><a href="../../../../net/corda/core/flows/FlowLogic.html#await-operation-">await</a>, <a href="../../../../net/corda/core/flows/FlowLogic.html#await-operation-">await</a>, <a href="../../../../net/corda/core/flows/FlowLogic.html#call--">call</a>, <a href="../../../../net/corda/core/flows/FlowLogic.html#checkFlowIsNotKilled--">checkFlowIsNotKilled</a>, <a href="../../../../net/corda/core/flows/FlowLogic.html#checkFlowIsNotKilled-lazyMessage-">checkFlowIsNotKilled</a>, <a href="../../../../net/corda/core/flows/FlowLogic.html#checkFlowPermission-permissionName-extraAuditData-">checkFlowPermission</a>, <a href="../../../../net/corda/core/flows/FlowLogic.html#close-sessions-">close</a>, <a href="../../../../net/corda/core/flows/FlowLogic.html#flowStackSnapshot--">flowStackSnapshot</a>, <a href="../../../../net/corda/core/flows/FlowLogic.html#getFlowInfo-otherParty-">getFlowInfo</a>, <a href="../../../../net/corda/core/flows/FlowLogic.html#getLogger--">getLogger</a>, <a href="../../../../net/corda/core/flows/FlowLogic.html#getOurIdentity--">getOurIdentity</a>, <a href="../../../../net/corda/core/flows/FlowLogic.html#getOurIdentityAndCert--">getOurIdentityAndCert</a>, <a href="../../../../net/corda/core/flows/FlowLogic.html#getProgressTracker--">getProgressTracker</a>, <a href="../../../../net/corda/core/flows/FlowLogic.html#getRunId--">getRunId</a>, <a href="../../../../net/corda/core/flows/FlowLogic.html#getServiceHub--">getServiceHub</a>, <a href="../../../../net/corda/core/flows/FlowLogic.html#initiateFlow-destination-">initiateFlow</a>, <a href="../../../../net/corda/core/flows/FlowLogic.html#initiateFlow-party-">initiateFlow</a>, <a href="../../../../net/corda/core/flows/FlowLogic.html#isKilled--">isKilled</a>, <a href="../../../../net/corda/core/flows/FlowLogic.html#persistFlowStackSnapshot--">persistFlowStackSnapshot</a>, <a href="../../../../net/corda/core/flows/FlowLogic.html#receive-receiveType-otherParty-">receive</a>, <a href="../../../../net/corda/core/flows/FlowLogic.html#receiveAll-receiveType-sessions-maySkipCheckpoint-">receiveAll</a>, <a href="../../../../net/corda/core/flows/FlowLogic.html#receiveAllMap-sessions-maySkipCheckpoint-">receiveAllMap</a>, <a href="../../../../net/corda/core/flows/FlowLogic.html#recordAuditEvent-eventType-comment-extraAuditData-">recordAuditEvent</a>, <a href="../../../../net/corda/core/flows/FlowLogic.html#send-otherParty-payload-">send</a>, <a href="../../../../net/corda/core/flows/FlowLogic.html#sendAll-payload-sessions-maySkipCheckpoint-">sendAll</a>, <a href="../../../../net/corda/core/flows/FlowLogic.html#sendAllMap-payloadsPerSession-maySkipCheckpoint-">sendAllMap</a>, <a href="../../../../net/corda/core/flows/FlowLogic.html#sendAndReceive-receiveType-otherParty-payload-">sendAndReceive</a>, <a href="../../../../net/corda/core/flows/FlowLogic.html#subFlow-subLogic-">subFlow</a>, <a href="../../../../net/corda/core/flows/FlowLogic.html#track--">track</a>, <a href="../../../../net/corda/core/flows/FlowLogic.html#trackStepsTree--">trackStepsTree</a>, <a href="../../../../net/corda/core/flows/FlowLogic.html#trackStepsTreeIndex--">trackStepsTreeIndex</a>, <a href="../../../../net/corda/core/flows/FlowLogic.html#waitForLedgerCommit-hash-maySkipCheckpoint-">waitForLedgerCommit</a>, <a href="../../../../net/corda/core/flows/FlowLogic.html#waitForStateConsumption-stateRefs-">waitForStateConsumption</a></code></li>
</ul>
</li>
</ul>
</li>
</ul>
</div>
<div class="details">
<ul class="blockList">
<li class="blockList">
<!-- ============ FIELD DETAIL =========== -->
<ul class="blockList">
<li class="blockList"><a name="field.detail">
<!--   -->
</a>
<h3>Field Detail</h3>
<a name="Companion">
<!--   -->
</a>
<ul class="blockListLast">
<li class="blockList">
<h4>Companion</h4>
<pre>public static&nbsp;<a href="../../../../net/corda/core/flows/CollectSignaturesFlow.Companion.html" title="type parameter in CollectSignaturesFlow.Companion">CollectSignaturesFlow.Companion</a> Companion</pre>
</li>
</ul>
</li>
</ul>
<!-- ========= CONSTRUCTOR DETAIL ======== -->
<ul class="blockList">
<li class="blockList"><a name="constructor.detail">
<!--   -->
</a>
<h3>Constructor Detail</h3>
<a name="CollectSignaturesFlow-partiallySignedTx-sessionsToCollectFrom-myOptionalKeys-progressTracker-">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>CollectSignaturesFlow</h4>
<pre>public&nbsp;CollectSignaturesFlow(<a href="../../../../net/corda/core/transactions/SignedTransaction.html" title="type parameter in SignedTransaction">SignedTransaction</a>&nbsp;partiallySignedTx,
                             java.util.Collection&lt;? extends net.corda.core.flows.FlowSession&gt;&nbsp;sessionsToCollectFrom,
                             java.lang.Iterable&lt;? extends java.security.PublicKey&gt;&nbsp;myOptionalKeys,
                             <a href="../../../../net/corda/core/utilities/ProgressTracker.html" title="type parameter in ProgressTracker">ProgressTracker</a>&nbsp;progressTracker)</pre>
<div class="block"><p><p>The <a href="../../../../net/corda/core/flows/CollectSignaturesFlow.html" title="class in net.corda.core.flows"><code>class CollectSignaturesFlow</code></a> is used to automate the collection of counterparty signatures for a given transaction.</p></p><p><p><p>You would typically use this flow after you have built a transaction with the TransactionBuilder and signed it with
your key pair. If there are additional signatures to collect then they can be collected using this flow. Signatures
are collected based upon the <a href="../../../../net/corda/core/transactions/WireTransaction.html#getRequiredSigningKeys--"><code>WireTransaction.getRequiredSigningKeys</code></a> property which contains the union of all the PublicKeys
listed in the transaction's commands as well as a notary's public key, if required. This flow returns a
<a href="../../../../net/corda/core/transactions/SignedTransaction.html" title="class in net.corda.core.transactions"><code>class SignedTransaction</code></a> which can then be passed to the <a href="../../../../net/corda/core/flows/FinalityFlow.html" title="class in net.corda.core.flows"><code>class FinalityFlow</code></a> for notarisation. The other side of this flow is
the <a href="../../../../net/corda/core/flows/SignTransactionFlow.html" title="class in net.corda.core.flows"><code>class SignTransactionFlow</code></a>.</p><p><strong>WARNING</strong>: This flow ONLY works with ServiceHub.legalIdentityKeys and WILL break if used with randomly generated
keys by the <a href="../../../../net/corda/core/node/ServiceHub.html#getKeyManagementService--"><code>ServiceHub.getKeyManagementService</code></a>.</p><p>Usage:</p><ul><li><p>Call the <a href="../../../../net/corda/core/flows/CollectSignaturesFlow.html" title="class in net.corda.core.flows"><code>class CollectSignaturesFlow</code></a> flow as a <a href="../../../../net/corda/core/flows/FlowLogic.html#subFlow-subLogic-"><code>FlowLogic.subFlow</code></a> and pass it a <a href="../../../../net/corda/core/transactions/SignedTransaction.html" title="class in net.corda.core.transactions"><code>class SignedTransaction</code></a> which has at least been
signed by the transaction creator (and possibly an oracle, if required)</p></li><li><p>The flow expects that the calling node has signed the provided transaction, if not the flow will fail</p></li><li><p>The flow will also fail if:</p></li></ul><ol><li><p>The provided transaction is invalid</p></li><li><p>Any of the required signing parties cannot be found in the <a href="../../../../net/corda/core/node/ServiceHub.html#getNetworkMapCache--"><code>ServiceHub.getNetworkMapCache</code></a> of the initiator</p></li><li><p>If the wrong key has been used by a counterparty to sign the transaction</p></li><li><p>The counterparty rejects the provided transaction</p></li></ol><ul><li><p>The flow will return a <a href="../../../../net/corda/core/transactions/SignedTransaction.html" title="class in net.corda.core.transactions"><code>class SignedTransaction</code></a> with all the counterparty signatures (but not the notary's!)</p></li><li><p>If the provided transaction has already been signed by all counterparties then this flow simply returns the
provided transaction without contacting any counterparties</p></li><li><p>Call the <a href="../../../../net/corda/core/flows/FinalityFlow.html" title="class in net.corda.core.flows"><code>class FinalityFlow</code></a> with the return value of this flow</p></li></ul><p>Example - issuing a multi-lateral agreement which requires N signatures:</p><code><pre>    val builder = TransactionBuilder(notaryRef)
    val issueCommand = Command(Agreement.Commands.Issue(), state.participants)

    builder.withItems(state, issueCommand)
    builder.toWireTransaction().toLedgerTransaction(serviceHub).verify()

    // Transaction creator signs transaction.
    val ptx = serviceHub.signInitialTransaction(builder)

    // Call to CollectSignaturesFlow.
    // The returned signed transaction will have all signatures appended apart from the notary's.
    val stx = subFlow(CollectSignaturesFlow(ptx))</pre></code></p></p></div>
<dl>
<dt><span class="paramLabel">Parameters:</span></dt>
<dd><code>partiallySignedTx</code> - Transaction to collect the remaining signatures for</dd>
<dd><code>sessionsToCollectFrom</code> - A session for every party we need to collect a signature from.  Must be an exact match.</dd>
<dd><code>myOptionalKeys</code> - set of keys in the transaction which are owned by this node. This includes keys used on commands, notjust in the states. If null, the default well known identity of the node is used.</dd>
<dd><code>progressTracker</code> - <p>Override this to provide a <a href="../../../../net/corda/core/utilities/ProgressTracker.html" title="class in net.corda.core.utilities"><code>class ProgressTracker</code></a>. If one is provided and stepped, the framework will do something
helpful with the progress reports e.g record to the audit service. If this flow is invoked as a subflow of another,
then the tracker will be made a child of the current step in the parent. If it's null, this flow doesn't track
progress.</p><p>Note that this has to return a tracker before the flow is invoked. You can't change your mind half way
through.</p></dd>
<dd><code>partiallySignedTx</code> - Transaction to collect the remaining signatures for</dd>
<dd><code>sessionsToCollectFrom</code> - A session for every party we need to collect a signature from.  Must be an exact match.</dd>
<dd><code>myOptionalKeys</code> - set of keys in the transaction which are owned by this node. This includes keys used on commands, not
just in the states. If null, the default well known identity of the node is used.</dd>
<dt><span class="seeLabel">See Also:</span></dt>
<dd><a href="../../../../net/corda/core/flows/CollectSignaturesFlow.html" title="class in net.corda.core.flows"><code>class CollectSignaturesFlow</code></a>, 
<a href="../../../../net/corda/core/transactions/WireTransaction.html#getRequiredSigningKeys--"><code>WireTransaction.getRequiredSigningKeys</code></a>, 
<a href="../../../../net/corda/core/transactions/SignedTransaction.html" title="class in net.corda.core.transactions"><code>class SignedTransaction</code></a>, 
<a href="../../../../net/corda/core/flows/FinalityFlow.html" title="class in net.corda.core.flows"><code>class FinalityFlow</code></a>, 
<a href="../../../../net/corda/core/flows/SignTransactionFlow.html" title="class in net.corda.core.flows"><code>class SignTransactionFlow</code></a>, 
<a href="../../../../net/corda/core/node/ServiceHub.html#getKeyManagementService--"><code>ServiceHub.getKeyManagementService</code></a>, 
<a href="../../../../net/corda/core/flows/CollectSignaturesFlow.html" title="class in net.corda.core.flows"><code>class CollectSignaturesFlow</code></a>, 
<a href="../../../../net/corda/core/flows/FlowLogic.html#subFlow-subLogic-"><code>FlowLogic.subFlow</code></a>, 
<a href="../../../../net/corda/core/transactions/SignedTransaction.html" title="class in net.corda.core.transactions"><code>class SignedTransaction</code></a>, 
<a href="../../../../net/corda/core/node/ServiceHub.html#getNetworkMapCache--"><code>ServiceHub.getNetworkMapCache</code></a>, 
<a href="../../../../net/corda/core/transactions/SignedTransaction.html" title="class in net.corda.core.transactions"><code>class SignedTransaction</code></a>, 
<a href="../../../../net/corda/core/flows/FinalityFlow.html" title="class in net.corda.core.flows"><code>class FinalityFlow</code></a></dd>
</dl>
</li>
</ul>
<a name="CollectSignaturesFlow-partiallySignedTx-sessionsToCollectFrom-progressTracker-">
<!--   -->
</a>
<ul class="blockListLast">
<li class="blockList">
<h4>CollectSignaturesFlow</h4>
<pre>public&nbsp;CollectSignaturesFlow(<a href="../../../../net/corda/core/transactions/SignedTransaction.html" title="type parameter in SignedTransaction">SignedTransaction</a>&nbsp;partiallySignedTx,
                             java.util.Collection&lt;? extends net.corda.core.flows.FlowSession&gt;&nbsp;sessionsToCollectFrom,
                             <a href="../../../../net/corda/core/utilities/ProgressTracker.html" title="type parameter in ProgressTracker">ProgressTracker</a>&nbsp;progressTracker)</pre>
</li>
</ul>
</li>
</ul>
<!-- ============ METHOD DETAIL ========== -->
<ul class="blockList">
<li class="blockList"><a name="method.detail">
<!--   -->
</a>
<h3>Method Detail</h3>
<a name="call--">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>call</h4>
<pre>public&nbsp;<a href="../../../../net/corda/core/transactions/SignedTransaction.html" title="type parameter in SignedTransaction">SignedTransaction</a>&nbsp;call()</pre>
<div class="block"><p><p>This is where you fill out your business logic.</p></p></div>
</li>
</ul>
<a name="getPartiallySignedTx--">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>getPartiallySignedTx</h4>
<pre>public&nbsp;<a href="../../../../net/corda/core/transactions/SignedTransaction.html" title="type parameter in SignedTransaction">SignedTransaction</a>&nbsp;getPartiallySignedTx()</pre>
<div class="block"><p>Transaction to collect the remaining signatures for</p></div>
</li>
</ul>
<a name="getSessionsToCollectFrom--">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>getSessionsToCollectFrom</h4>
<pre>public&nbsp;java.util.Collection&lt;net.corda.core.flows.FlowSession&gt;&nbsp;getSessionsToCollectFrom()</pre>
<div class="block"><p>A session for every party we need to collect a signature from.</p><p><p>  Must be an exact match.</p></p></div>
</li>
</ul>
<a name="getMyOptionalKeys--">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>getMyOptionalKeys</h4>
<pre>public&nbsp;java.lang.Iterable&lt;java.security.PublicKey&gt;&nbsp;getMyOptionalKeys()</pre>
<div class="block"><p>set of keys in the transaction which are owned by this node.</p><p><p> This includes keys used on commands, notjust in the states. If null, the default well known identity of the node is used.</p></p></div>
</li>
</ul>
<a name="getProgressTracker--">
<!--   -->
</a>
<ul class="blockListLast">
<li class="blockList">
<h4>getProgressTracker</h4>
<pre>public&nbsp;<a href="../../../../net/corda/core/utilities/ProgressTracker.html" title="type parameter in ProgressTracker">ProgressTracker</a>&nbsp;getProgressTracker()</pre>
<div class="block"><p><p>Override this to provide a <a href="../../../../net/corda/core/utilities/ProgressTracker.html" title="class in net.corda.core.utilities"><code>class ProgressTracker</code></a>. If one is provided and stepped, the framework will do something
helpful with the progress reports e.g record to the audit service. If this flow is invoked as a subflow of another,
then the tracker will be made a child of the current step in the parent. If it's null, this flow doesn't track
progress.</p></p><p><p><p>Note that this has to return a tracker before the flow is invoked. You can't change your mind half way
through.</p></p></p></div>
<dl>
<dt><span class="seeLabel">See Also:</span></dt>
<dd><a href="../../../../net/corda/core/utilities/ProgressTracker.html" title="class in net.corda.core.utilities"><code>class ProgressTracker</code></a></dd>
</dl>
</li>
</ul>
</li>
</ul>
</li>
</ul>
</div>
</div>
<!-- ========= END OF CLASS DATA ========= -->
<!-- ======= START OF BOTTOM NAVBAR ====== -->
<div class="bottomNav"><a name="navbar.bottom">
<!--   -->
</a>
<div class="skipNav"><a href="#skip.navbar.bottom" title="Skip navigation links">Skip navigation links</a></div>
<a name="navbar.bottom.firstrow">
<!--   -->
</a>
<ul class="navList" title="Navigation">
<li><a href="../../../../overview-summary.html">Overview</a></li>
<li><a href="package-summary.html">Package</a></li>
<li class="navBarCell1Rev">Class</li>
<li><a href="package-tree.html">Tree</a></li>
<li><a href="../../../../deprecated-list.html">Deprecated</a></li>
<li><a href="../../../../index-all.html">Index</a></li>
<li><a href="../../../../help-doc.html">Help</a></li>
</ul>
</div>
<div class="subNav">
<ul class="navList">
<li><a href="../../../../net/corda/core/flows/CollectSignatureFlow.html" title="class in net.corda.core.flows"><span class="typeNameLink">Prev&nbsp;Class</span></a></li>
<li><a href="../../../../net/corda/core/flows/TimeWindowInvalid.Companion.html" title="class in net.corda.core.flows"><span class="typeNameLink">Next&nbsp;Class</span></a></li>
</ul>
<ul class="navList">
<li><a href="../../../../index.html?net/corda/core/flows/CollectSignaturesFlow.html" target="_top">Frames</a></li>
<li><a href="CollectSignaturesFlow.html" target="_top">No&nbsp;Frames</a></li>
</ul>
<ul class="navList" id="allclasses_navbar_bottom">
<li><a href="../../../../allclasses-noframe.html">All&nbsp;Classes</a></li>
</ul>
<div>
<script type="text/javascript"><!--
  allClassesLink = document.getElementById("allclasses_navbar_bottom");
  if(window==top) {
    allClassesLink.style.display = "block";
  }
  else {
    allClassesLink.style.display = "none";
  }
  //-->
</script>
</div>
<div>
<ul class="subNavList">
<li>Summary:&nbsp;</li>
<li><a href="#nested.class.summary">Nested</a>&nbsp;|&nbsp;</li>
<li><a href="#field.summary">Field</a>&nbsp;|&nbsp;</li>
<li><a href="#constructor.summary">Constr</a>&nbsp;|&nbsp;</li>
<li><a href="#method.summary">Method</a></li>
</ul>
<ul class="subNavList">
<li>Detail:&nbsp;</li>
<li><a href="#field.detail">Field</a>&nbsp;|&nbsp;</li>
<li><a href="#constructor.detail">Constr</a>&nbsp;|&nbsp;</li>
<li><a href="#method.detail">Method</a></li>
</ul>
</div>
<a name="skip.navbar.bottom">
<!--   -->
</a></div>
<!-- ======== END OF BOTTOM NAVBAR ======= -->
</body>
</html>
