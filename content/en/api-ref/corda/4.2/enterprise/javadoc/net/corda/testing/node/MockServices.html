<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<!-- NewPage -->
<html lang="en">
<head>
<!-- Generated by javadoc (1.8.0_202) on Fri Mar 20 11:25:48 GMT 2020 -->
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<title>MockServices</title>
<meta name="date" content="2020-03-20">
<meta name="keywords" content="net.corda.testing.node.MockServices class">
<meta name="keywords" content="Companion">
<meta name="keywords" content="getCordappClassloader()">
<meta name="keywords" content="recordTransactions()">
<meta name="keywords" content="getNetworkParameters()">
<meta name="keywords" content="getAttachments()">
<meta name="keywords" content="getVaultService()">
<meta name="keywords" content="getContractUpgradeService()">
<meta name="keywords" content="getNetworkMapCache()">
<meta name="keywords" content="getClock()">
<meta name="keywords" content="getMyInfo()">
<meta name="keywords" content="getTransactionVerifierService()">
<meta name="keywords" content="getCordappProvider()">
<meta name="keywords" content="getNetworkParametersService()">
<meta name="keywords" content="setNetworkParametersService()">
<meta name="keywords" content="getServicesForResolution()">
<meta name="keywords" content="cordaService()">
<meta name="keywords" content="jdbcSession()">
<meta name="keywords" content="withEntityManager()">
<meta name="keywords" content="registerUnloadHandler()">
<meta name="keywords" content="addMockCordapp()">
<meta name="keywords" content="loadState()">
<meta name="keywords" content="loadStates()">
<meta name="keywords" content="loadContractAttachment()">
<meta name="keywords" content="getValidatedTransactions()">
<meta name="keywords" content="getIdentityService()">
<meta name="keywords" content="getKeyManagementService()">
<meta name="keywords" content="makeTestDataSourceProperties()">
<meta name="keywords" content="makeTestDatabaseAndMockServices()">
<meta name="keywords" content="makeTestDatabaseAndPersistentServices()">
<link rel="stylesheet" type="text/css" href="../../../../stylesheet.css" title="Style">
<script type="text/javascript" src="../../../../script.js"></script>

<meta name="docsearch:language" content="en">
<meta name="docsearch:version" content="4.2">
<meta name="docsearch:project" content="corda-enterprise">
</head>
<body>
<script type="text/javascript"><!--
    try {
        if (location.href.indexOf('is-external=true') == -1) {
            parent.document.title="MockServices";
        }
    }
    catch(err) {
    }
//-->
var methods = {"i0":10,"i1":10,"i2":10,"i3":10,"i4":10,"i5":10,"i6":10,"i7":10,"i8":10,"i9":10,"i10":10,"i11":10,"i12":10,"i13":10,"i14":10,"i15":10,"i16":10,"i17":10,"i18":10,"i19":10,"i20":10,"i21":9,"i22":9,"i23":9,"i24":9,"i25":9,"i26":10,"i27":10,"i28":10,"i29":10,"i30":10};
var tabs = {65535:["t0","All Methods"],1:["t1","Static Methods"],2:["t2","Instance Methods"],8:["t4","Concrete Methods"]};
var altColor = "altColor";
var rowColor = "rowColor";
var tableTab = "tableTab";
var activeTableTab = "activeTableTab";
</script>
<noscript>
<div>JavaScript is disabled on your browser.</div>
</noscript>
<!-- ========= START OF TOP NAVBAR ======= -->
<div class="topNav"><a name="navbar.top">
<!--   -->
</a>
<div class="skipNav"><a href="#skip.navbar.top" title="Skip navigation links">Skip navigation links</a></div>
<a name="navbar.top.firstrow">
<!--   -->
</a>
<ul class="navList" title="Navigation">
<li><a href="../../../../overview-summary.html">Overview</a></li>
<li><a href="package-summary.html">Package</a></li>
<li class="navBarCell1Rev">Class</li>
<li><a href="package-tree.html">Tree</a></li>
<li><a href="../../../../deprecated-list.html">Deprecated</a></li>
<li><a href="../../../../index-all.html">Index</a></li>
<li><a href="../../../../help-doc.html">Help</a></li>
</ul>
</div>
<div class="subNav">
<ul class="navList">
<li><a href="../../../../net/corda/testing/node/MockNodeParameters.html" title="class in net.corda.testing.node"><span class="typeNameLink">Prev&nbsp;Class</span></a></li>
<li><a href="../../../../net/corda/testing/node/MockServicesKt.html" title="class in net.corda.testing.node"><span class="typeNameLink">Next&nbsp;Class</span></a></li>
</ul>
<ul class="navList">
<li><a href="../../../../index.html?net/corda/testing/node/MockServices.html" target="_top">Frames</a></li>
<li><a href="MockServices.html" target="_top">No&nbsp;Frames</a></li>
</ul>
<ul class="navList" id="allclasses_navbar_top">
<li><a href="../../../../allclasses-noframe.html">All&nbsp;Classes</a></li>
</ul>
<div>
<script type="text/javascript"><!--
  allClassesLink = document.getElementById("allclasses_navbar_top");
  if(window==top) {
    allClassesLink.style.display = "block";
  }
  else {
    allClassesLink.style.display = "none";
  }
  //-->
</script>
</div>
<div>
<ul class="subNavList">
<li>Summary:&nbsp;</li>
<li><a href="#nested.class.summary">Nested</a>&nbsp;|&nbsp;</li>
<li><a href="#field.summary">Field</a>&nbsp;|&nbsp;</li>
<li><a href="#constructor.summary">Constr</a>&nbsp;|&nbsp;</li>
<li><a href="#method.summary">Method</a></li>
</ul>
<ul class="subNavList">
<li>Detail:&nbsp;</li>
<li><a href="#field.detail">Field</a>&nbsp;|&nbsp;</li>
<li><a href="#constructor.detail">Constr</a>&nbsp;|&nbsp;</li>
<li><a href="#method.detail">Method</a></li>
</ul>
</div>
<a name="skip.navbar.top">
<!--   -->
</a></div>
<!-- ========= END OF TOP NAVBAR ========= -->
<!-- ======== START OF CLASS DATA ======== -->
<div class="header">
<div class="subTitle">net.corda.testing.node</div>
<h2 title="Class MockServices" class="title">Class MockServices</h2>
</div>
<div class="contentContainer">
<ul class="inheritance">
<li>net.corda.testing.node.MockServices</li>
</ul>
<div class="description">
<ul class="blockList">
<li class="blockList">
<dl>
<dt>All Implemented Interfaces:</dt>
<dd><a href="../../../../net/corda/core/node/ServiceHub.html" title="interface in net.corda.core.node">ServiceHub</a>, <a href="../../../../net/corda/core/node/ServicesForResolution.html" title="interface in net.corda.core.node">ServicesForResolution</a></dd>
</dl>
<hr>
<br>
<pre>public class <span class="typeNameLabel">MockServices</span>
implements <a href="../../../../net/corda/core/node/ServiceHub.html" title="interface in net.corda.core.node">ServiceHub</a></pre>
<div class="block"><p><p>An implementation of <a href="../../../../net/corda/core/node/ServiceHub.html" title="interface in net.corda.core.node"><code>interface ServiceHub</code></a> that is designed for in-memory unit tests of contract validation logic. It has
enough functionality to do tests of code that queries the vault, inserts to the vault, and constructs/checks
transactions. However it isn't enough to test flows and other aspects of an app that require a network. For that
you should investigate <a href="../../../../net/corda/testing/node/MockNetwork.html" title="class in net.corda.testing.node"><code>class MockNetwork</code></a>.</p></p><p><p><p>There are a variety of constructors that can be used to supply enough data to simulate a node. Each mock service hub
must have at least an identity of its own. The other components have defaults that work in most situations.</p></p></p></div>
<dl>
<dt><span class="seeLabel">See Also:</span></dt>
<dd><a href="../../../../net/corda/core/node/ServiceHub.html" title="interface in net.corda.core.node"><code>interface ServiceHub</code></a>, 
<a href="../../../../net/corda/testing/node/MockNetwork.html" title="class in net.corda.testing.node"><code>class MockNetwork</code></a></dd>
</dl>
</li>
</ul>
</div>
<div class="summary">
<ul class="blockList">
<li class="blockList">
<!-- ======== NESTED CLASS SUMMARY ======== -->
<ul class="blockList">
<li class="blockList"><a name="nested.class.summary">
<!--   -->
</a>
<h3>Nested Class Summary</h3>
<table class="memberSummary" border="0" cellpadding="3" cellspacing="0" summary="Nested Class Summary table, listing nested classes, and an explanation">
<caption><span>Nested Classes</span><span class="tabEnd">&nbsp;</span></caption>
<tr>
<th class="colFirst" scope="col">Modifier and Type</th>
<th class="colLast" scope="col">Class and Description</th>
</tr>
<tr class="altColor">
<td class="colFirst"><code>static class&nbsp;</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../../net/corda/testing/node/MockServices.Companion.html" title="class in net.corda.testing.node">MockServices.Companion</a></span></code>&nbsp;</td>
</tr>
</table>
<ul class="blockList">
<li class="blockList"><a name="nested.classes.inherited.from.class.net.corda.core.node.ServiceHub">
<!--   -->
</a>
<h3>Nested classes/interfaces inherited from interface&nbsp;net.corda.core.node.<a href="../../../../net/corda/core/node/ServiceHub.html" title="interface in net.corda.core.node">ServiceHub</a></h3>
<code><a href="../../../../net/corda/core/node/ServiceHub.DefaultImpls.html" title="class in net.corda.core.node">ServiceHub.DefaultImpls</a></code></li>
</ul>
</li>
</ul>
<!-- =========== FIELD SUMMARY =========== -->
<ul class="blockList">
<li class="blockList"><a name="field.summary">
<!--   -->
</a>
<h3>Field Summary</h3>
<table class="memberSummary" border="0" cellpadding="3" cellspacing="0" summary="Field Summary table, listing fields, and an explanation">
<caption><span>Fields</span><span class="tabEnd">&nbsp;</span></caption>
<tr>
<th class="colFirst" scope="col">Modifier and Type</th>
<th class="colLast" scope="col">Field and Description</th>
</tr>
<tr class="altColor">
<td class="colFirst"><code>static <a href="../../../../net/corda/testing/node/MockServices.Companion.html" title="type parameter in MockServices.Companion">MockServices.Companion</a></code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../../net/corda/testing/node/MockServices.html#Companion">Companion</a></span></code>&nbsp;</td>
</tr>
</table>
</li>
</ul>
<!-- ======== CONSTRUCTOR SUMMARY ======== -->
<ul class="blockList">
<li class="blockList"><a name="constructor.summary">
<!--   -->
</a>
<h3>Constructor Summary</h3>
<table class="memberSummary" border="0" cellpadding="3" cellspacing="0" summary="Constructor Summary table, listing constructors, and an explanation">
<caption><span>Constructors</span><span class="tabEnd">&nbsp;</span></caption>
<tr>
<th class="colOne" scope="col">Constructor and Description</th>
</tr>
<tr class="altColor">
<td class="colOne"><code><span class="memberNameLink"><a href="../../../../net/corda/testing/node/MockServices.html#MockServices-cordappPackages-initialIdentity-identityService-moreKeys-">MockServices</a></span>(java.lang.Iterable&lt;java.lang.String&gt;&nbsp;cordappPackages,
            <a href="../../../../net/corda/testing/core/TestIdentity.html" title="type parameter in TestIdentity">TestIdentity</a>&nbsp;initialIdentity,
            <a href="../../../../net/corda/core/node/services/IdentityService.html" title="type parameter in IdentityService">IdentityService</a>&nbsp;identityService,
            java.security.KeyPair&nbsp;moreKeys)</code>
<div class="block">Create a mock <a href="../../../../net/corda/core/node/ServiceHub.html" title="interface in net.corda.core.node"><code>interface ServiceHub</code></a> that looks for app code in the given package names, uses the provided identity service
(you can get one from <a href="../../../../net/corda/testing/node/MockServicesKt.html#makeTestIdentityService-identities-"><code>MockServicesKt.makeTestIdentityService</code></a>) and represents the given identity.</div>
</td>
</tr>
<tr class="rowColor">
<td class="colOne"><code><span class="memberNameLink"><a href="../../../../net/corda/testing/node/MockServices.html#MockServices-cordappPackages-initialIdentity-moreKeys-">MockServices</a></span>(java.lang.Iterable&lt;java.lang.String&gt;&nbsp;cordappPackages,
            <a href="../../../../net/corda/testing/core/TestIdentity.html" title="type parameter in TestIdentity">TestIdentity</a>&nbsp;initialIdentity,
            java.security.KeyPair&nbsp;moreKeys)</code>
<div class="block">Create a mock <a href="../../../../net/corda/core/node/ServiceHub.html" title="interface in net.corda.core.node"><code>interface ServiceHub</code></a> that looks for app code in the given package names, uses the provided identity service
(you can get one from <a href="../../../../net/corda/testing/node/MockServicesKt.html#makeTestIdentityService-identities-"><code>MockServicesKt.makeTestIdentityService</code></a>) and represents the given identity.</div>
</td>
</tr>
<tr class="altColor">
<td class="colOne"><code><span class="memberNameLink"><a href="../../../../net/corda/testing/node/MockServices.html#MockServices-cordappPackages-initialIdentity-identityService-networkParameters-moreKeys-">MockServices</a></span>(java.lang.Iterable&lt;java.lang.String&gt;&nbsp;cordappPackages,
            <a href="../../../../net/corda/testing/core/TestIdentity.html" title="type parameter in TestIdentity">TestIdentity</a>&nbsp;initialIdentity,
            <a href="../../../../net/corda/core/node/services/IdentityService.html" title="type parameter in IdentityService">IdentityService</a>&nbsp;identityService,
            <a href="../../../../net/corda/core/node/NetworkParameters.html" title="type parameter in NetworkParameters">NetworkParameters</a>&nbsp;networkParameters,
            java.security.KeyPair&nbsp;moreKeys)</code>&nbsp;</td>
</tr>
<tr class="rowColor">
<td class="colOne"><code><span class="memberNameLink"><a href="../../../../net/corda/testing/node/MockServices.html#MockServices-cordappPackages-initialIdentity-identityService-networkParameters-moreKeys-keyManagementService-">MockServices</a></span>(java.lang.Iterable&lt;java.lang.String&gt;&nbsp;cordappPackages,
            <a href="../../../../net/corda/testing/core/TestIdentity.html" title="type parameter in TestIdentity">TestIdentity</a>&nbsp;initialIdentity,
            <a href="../../../../net/corda/core/node/services/IdentityService.html" title="type parameter in IdentityService">IdentityService</a>&nbsp;identityService,
            <a href="../../../../net/corda/core/node/NetworkParameters.html" title="type parameter in NetworkParameters">NetworkParameters</a>&nbsp;networkParameters,
            java.security.KeyPair[]&nbsp;moreKeys,
            <a href="../../../../net/corda/core/node/services/KeyManagementService.html" title="type parameter in KeyManagementService">KeyManagementService</a>&nbsp;keyManagementService)</code>&nbsp;</td>
</tr>
<tr class="altColor">
<td class="colOne"><code><span class="memberNameLink"><a href="../../../../net/corda/testing/node/MockServices.html#MockServices-cordappPackages-initialIdentityName-identityService-key-moreKeys-">MockServices</a></span>(java.lang.Iterable&lt;java.lang.String&gt;&nbsp;cordappPackages,
            <a href="../../../../net/corda/core/identity/CordaX500Name.html" title="type parameter in CordaX500Name">CordaX500Name</a>&nbsp;initialIdentityName,
            <a href="../../../../net/corda/core/node/services/IdentityService.html" title="type parameter in IdentityService">IdentityService</a>&nbsp;identityService,
            java.security.KeyPair&nbsp;key,
            java.security.KeyPair&nbsp;moreKeys)</code>
<div class="block">Create a mock <a href="../../../../net/corda/core/node/ServiceHub.html" title="interface in net.corda.core.node"><code>interface ServiceHub</code></a> that looks for app code in the given package names, uses the provided identity service
(you can get one from <a href="../../../../net/corda/testing/node/MockServicesKt.html#makeTestIdentityService-identities-"><code>MockServicesKt.makeTestIdentityService</code></a>) and represents the given identity.</div>
</td>
</tr>
<tr class="rowColor">
<td class="colOne"><code><span class="memberNameLink"><a href="../../../../net/corda/testing/node/MockServices.html#MockServices-cordappPackages-initialIdentityName-key-moreKeys-">MockServices</a></span>(java.lang.Iterable&lt;java.lang.String&gt;&nbsp;cordappPackages,
            <a href="../../../../net/corda/core/identity/CordaX500Name.html" title="type parameter in CordaX500Name">CordaX500Name</a>&nbsp;initialIdentityName,
            java.security.KeyPair&nbsp;key,
            java.security.KeyPair&nbsp;moreKeys)</code>
<div class="block">Create a mock <a href="../../../../net/corda/core/node/ServiceHub.html" title="interface in net.corda.core.node"><code>interface ServiceHub</code></a> that looks for app code in the given package names, uses the provided identity service
(you can get one from <a href="../../../../net/corda/testing/node/MockServicesKt.html#makeTestIdentityService-identities-"><code>MockServicesKt.makeTestIdentityService</code></a>) and represents the given identity.</div>
</td>
</tr>
<tr class="altColor">
<td class="colOne"><code><span class="memberNameLink"><a href="../../../../net/corda/testing/node/MockServices.html#MockServices-cordappPackages-initialIdentityName-identityService-">MockServices</a></span>(java.lang.Iterable&lt;java.lang.String&gt;&nbsp;cordappPackages,
            <a href="../../../../net/corda/core/identity/CordaX500Name.html" title="type parameter in CordaX500Name">CordaX500Name</a>&nbsp;initialIdentityName,
            <a href="../../../../net/corda/core/node/services/IdentityService.html" title="type parameter in IdentityService">IdentityService</a>&nbsp;identityService)</code>
<div class="block">Create a mock <a href="../../../../net/corda/core/node/ServiceHub.html" title="interface in net.corda.core.node"><code>interface ServiceHub</code></a> that can't load CorDapp code, which uses the provided identity service
(you can get one from <a href="../../../../net/corda/testing/node/MockServicesKt.html#makeTestIdentityService-identities-"><code>MockServicesKt.makeTestIdentityService</code></a>) and which represents the given identity.</div>
</td>
</tr>
<tr class="rowColor">
<td class="colOne"><code><span class="memberNameLink"><a href="../../../../net/corda/testing/node/MockServices.html#MockServices-cordappPackages-initialIdentityName-">MockServices</a></span>(java.lang.Iterable&lt;java.lang.String&gt;&nbsp;cordappPackages,
            <a href="../../../../net/corda/core/identity/CordaX500Name.html" title="type parameter in CordaX500Name">CordaX500Name</a>&nbsp;initialIdentityName)</code>
<div class="block">Create a mock <a href="../../../../net/corda/core/node/ServiceHub.html" title="interface in net.corda.core.node"><code>interface ServiceHub</code></a> that can't load CorDapp code, which uses the provided identity service
(you can get one from <a href="../../../../net/corda/testing/node/MockServicesKt.html#makeTestIdentityService-identities-"><code>MockServicesKt.makeTestIdentityService</code></a>) and which represents the given identity.</div>
</td>
</tr>
<tr class="altColor">
<td class="colOne"><code><span class="memberNameLink"><a href="../../../../net/corda/testing/node/MockServices.html#MockServices-cordappPackages-">MockServices</a></span>(java.lang.Iterable&lt;java.lang.String&gt;&nbsp;cordappPackages)</code>
<div class="block">Create a mock <a href="../../../../net/corda/core/node/ServiceHub.html" title="interface in net.corda.core.node"><code>interface ServiceHub</code></a> that can't load CorDapp code, and which uses a default service identity.</div>
</td>
</tr>
<tr class="rowColor">
<td class="colOne"><code><span class="memberNameLink"><a href="../../../../net/corda/testing/node/MockServices.html#MockServices-initialIdentityName-identityService-key-moreKeys-">MockServices</a></span>(<a href="../../../../net/corda/core/identity/CordaX500Name.html" title="type parameter in CordaX500Name">CordaX500Name</a>&nbsp;initialIdentityName,
            <a href="../../../../net/corda/core/node/services/IdentityService.html" title="type parameter in IdentityService">IdentityService</a>&nbsp;identityService,
            java.security.KeyPair&nbsp;key,
            java.security.KeyPair&nbsp;moreKeys)</code>
<div class="block">Create a mock <a href="../../../../net/corda/core/node/ServiceHub.html" title="interface in net.corda.core.node"><code>interface ServiceHub</code></a> which uses the package of the caller to find CorDapp code. It uses the provided identity service
(you can get one from <a href="../../../../net/corda/testing/node/MockServicesKt.html#makeTestIdentityService-identities-"><code>MockServicesKt.makeTestIdentityService</code></a>) and which represents the given identity.</div>
</td>
</tr>
<tr class="altColor">
<td class="colOne"><code><span class="memberNameLink"><a href="../../../../net/corda/testing/node/MockServices.html#MockServices-initialIdentityName-key-moreKeys-">MockServices</a></span>(<a href="../../../../net/corda/core/identity/CordaX500Name.html" title="type parameter in CordaX500Name">CordaX500Name</a>&nbsp;initialIdentityName,
            java.security.KeyPair&nbsp;key,
            java.security.KeyPair&nbsp;moreKeys)</code>
<div class="block">Create a mock <a href="../../../../net/corda/core/node/ServiceHub.html" title="interface in net.corda.core.node"><code>interface ServiceHub</code></a> which uses the package of the caller to find CorDapp code. It uses the provided identity service
(you can get one from <a href="../../../../net/corda/testing/node/MockServicesKt.html#makeTestIdentityService-identities-"><code>MockServicesKt.makeTestIdentityService</code></a>) and which represents the given identity.</div>
</td>
</tr>
<tr class="rowColor">
<td class="colOne"><code><span class="memberNameLink"><a href="../../../../net/corda/testing/node/MockServices.html#MockServices-initialIdentityName-identityService-">MockServices</a></span>(<a href="../../../../net/corda/core/identity/CordaX500Name.html" title="type parameter in CordaX500Name">CordaX500Name</a>&nbsp;initialIdentityName,
            <a href="../../../../net/corda/core/node/services/IdentityService.html" title="type parameter in IdentityService">IdentityService</a>&nbsp;identityService)</code>
<div class="block">Create a mock <a href="../../../../net/corda/core/node/ServiceHub.html" title="interface in net.corda.core.node"><code>interface ServiceHub</code></a> which uses the package of the caller to find CorDapp code. It uses the provided identity service
(you can get one from <a href="../../../../net/corda/testing/node/MockServicesKt.html#makeTestIdentityService-identities-"><code>MockServicesKt.makeTestIdentityService</code></a>) and which represents the given identity. It has no keys.</div>
</td>
</tr>
<tr class="altColor">
<td class="colOne"><code><span class="memberNameLink"><a href="../../../../net/corda/testing/node/MockServices.html#MockServices-initialIdentityName-">MockServices</a></span>(<a href="../../../../net/corda/core/identity/CordaX500Name.html" title="type parameter in CordaX500Name">CordaX500Name</a>&nbsp;initialIdentityName)</code>
<div class="block">Create a mock <a href="../../../../net/corda/core/node/ServiceHub.html" title="interface in net.corda.core.node"><code>interface ServiceHub</code></a> which uses the package of the caller to find CorDapp code. It uses the provided identity service
(you can get one from <a href="../../../../net/corda/testing/node/MockServicesKt.html#makeTestIdentityService-identities-"><code>MockServicesKt.makeTestIdentityService</code></a>) and which represents the given identity. It has no keys.</div>
</td>
</tr>
<tr class="rowColor">
<td class="colOne"><code><span class="memberNameLink"><a href="../../../../net/corda/testing/node/MockServices.html#MockServices-cordappPackages-initialIdentityName-identityService-networkParameters-">MockServices</a></span>(java.util.List&lt;java.lang.String&gt;&nbsp;cordappPackages,
            <a href="../../../../net/corda/core/identity/CordaX500Name.html" title="type parameter in CordaX500Name">CordaX500Name</a>&nbsp;initialIdentityName,
            <a href="../../../../net/corda/core/node/services/IdentityService.html" title="type parameter in IdentityService">IdentityService</a>&nbsp;identityService,
            <a href="../../../../net/corda/core/node/NetworkParameters.html" title="type parameter in NetworkParameters">NetworkParameters</a>&nbsp;networkParameters)</code>&nbsp;</td>
</tr>
<tr class="altColor">
<td class="colOne"><code><span class="memberNameLink"><a href="../../../../net/corda/testing/node/MockServices.html#MockServices-cordappPackages-initialIdentityName-identityService-networkParameters-key-">MockServices</a></span>(java.util.List&lt;java.lang.String&gt;&nbsp;cordappPackages,
            <a href="../../../../net/corda/core/identity/CordaX500Name.html" title="type parameter in CordaX500Name">CordaX500Name</a>&nbsp;initialIdentityName,
            <a href="../../../../net/corda/core/node/services/IdentityService.html" title="type parameter in IdentityService">IdentityService</a>&nbsp;identityService,
            <a href="../../../../net/corda/core/node/NetworkParameters.html" title="type parameter in NetworkParameters">NetworkParameters</a>&nbsp;networkParameters,
            java.security.KeyPair&nbsp;key)</code>&nbsp;</td>
</tr>
<tr class="rowColor">
<td class="colOne"><code><span class="memberNameLink"><a href="../../../../net/corda/testing/node/MockServices.html#MockServices-firstIdentity-moreIdentities-">MockServices</a></span>(<a href="../../../../net/corda/testing/core/TestIdentity.html" title="type parameter in TestIdentity">TestIdentity</a>&nbsp;firstIdentity,
            net.corda.testing.core.TestIdentity&nbsp;moreIdentities)</code>
<div class="block">A helper constructor that requires at least one test identity to be registered, and which takes the package of
the caller as the package in which to find app code. This is the most convenient constructor and the one that
is normally worth using. The first identity is the identity of this service hub, the rest are identities that
it is aware of.</div>
</td>
</tr>
<tr class="altColor">
<td class="colOne"><code><span class="memberNameLink"><a href="../../../../net/corda/testing/node/MockServices.html#MockServices-firstIdentity-networkParameters-moreIdentities-">MockServices</a></span>(<a href="../../../../net/corda/testing/core/TestIdentity.html" title="type parameter in TestIdentity">TestIdentity</a>&nbsp;firstIdentity,
            <a href="../../../../net/corda/core/node/NetworkParameters.html" title="type parameter in NetworkParameters">NetworkParameters</a>&nbsp;networkParameters,
            net.corda.testing.core.TestIdentity&nbsp;moreIdentities)</code>&nbsp;</td>
</tr>
<tr class="rowColor">
<td class="colOne"><code><span class="memberNameLink"><a href="../../../../net/corda/testing/node/MockServices.html#MockServices-cordappPackages-firstIdentity-moreIdentities-">MockServices</a></span>(java.util.List&lt;java.lang.String&gt;&nbsp;cordappPackages,
            <a href="../../../../net/corda/testing/core/TestIdentity.html" title="type parameter in TestIdentity">TestIdentity</a>&nbsp;firstIdentity,
            net.corda.testing.core.TestIdentity&nbsp;moreIdentities)</code>&nbsp;</td>
</tr>
<tr class="altColor">
<td class="colOne"><code><span class="memberNameLink"><a href="../../../../net/corda/testing/node/MockServices.html#MockServices-cordappPackages-firstIdentity-networkParameters-moreIdentities-">MockServices</a></span>(java.util.List&lt;java.lang.String&gt;&nbsp;cordappPackages,
            <a href="../../../../net/corda/testing/core/TestIdentity.html" title="type parameter in TestIdentity">TestIdentity</a>&nbsp;firstIdentity,
            <a href="../../../../net/corda/core/node/NetworkParameters.html" title="type parameter in NetworkParameters">NetworkParameters</a>&nbsp;networkParameters,
            net.corda.testing.core.TestIdentity&nbsp;moreIdentities)</code>&nbsp;</td>
</tr>
<tr class="rowColor">
<td class="colOne"><code><span class="memberNameLink"><a href="../../../../net/corda/testing/node/MockServices.html#MockServices--">MockServices</a></span>()</code>
<div class="block">Create a mock <a href="../../../../net/corda/core/node/ServiceHub.html" title="interface in net.corda.core.node"><code>interface ServiceHub</code></a> which uses the package of the caller to find CorDapp code. It uses a default service
identity.</div>
</td>
</tr>
</table>
</li>
</ul>
<!-- ========== METHOD SUMMARY =========== -->
<ul class="blockList">
<li class="blockList"><a name="method.summary">
<!--   -->
</a>
<h3>Method Summary</h3>
<table class="memberSummary" border="0" cellpadding="3" cellspacing="0" summary="Method Summary table, listing methods, and an explanation">
<caption><span id="t0" class="activeTableTab"><span>All Methods</span><span class="tabEnd">&nbsp;</span></span><span id="t1" class="tableTab"><span><a href="javascript:show(1);">Static Methods</a></span><span class="tabEnd">&nbsp;</span></span><span id="t2" class="tableTab"><span><a href="javascript:show(2);">Instance Methods</a></span><span class="tabEnd">&nbsp;</span></span><span id="t4" class="tableTab"><span><a href="javascript:show(8);">Concrete Methods</a></span><span class="tabEnd">&nbsp;</span></span></caption>
<tr>
<th class="colFirst" scope="col">Modifier and Type</th>
<th class="colLast" scope="col">Method and Description</th>
</tr>
<tr id="i0" class="altColor">
<td class="colFirst"><code>void</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../../net/corda/testing/node/MockServices.html#addMockCordapp-contractClassName-">addMockCordapp</a></span>(java.lang.String&nbsp;contractClassName)</code>
<div class="block">Add the given package name to the list of packages which will be scanned for cordapp contract verification code</div>
</td>
</tr>
<tr id="i1" class="rowColor">
<td class="colFirst"><code>&lt;T extends <a href="../../../../net/corda/core/serialization/SerializeAsToken.html" title="type parameter in SerializeAsToken">SerializeAsToken</a>&gt;<br>T</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../../net/corda/testing/node/MockServices.html#cordaService-type-">cordaService</a></span>(java.lang.Class&lt;T&gt;&nbsp;type)</code>
<div class="block">Return the singleton instance of the given Corda service type. This is a class that is annotated with
<a href="../../../../net/corda/core/node/services/CordaService.html" title="interface in net.corda.core.node.services"><code>interface CordaService</code></a> and will have automatically been registered by the node.</div>
</td>
</tr>
<tr id="i2" class="altColor">
<td class="colFirst"><code><a href="../../../../net/corda/testing/services/MockAttachmentStorage.html" title="type parameter in MockAttachmentStorage">MockAttachmentStorage</a></code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../../net/corda/testing/node/MockServices.html#getAttachments--">getAttachments</a></span>()</code>
<div class="block">Provides access to storage of arbitrary JAR files (which may contain only data, no code).</div>
</td>
</tr>
<tr id="i3" class="rowColor">
<td class="colFirst"><code><a href="../../../../net/corda/testing/node/TestClock.html" title="type parameter in TestClock">TestClock</a></code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../../net/corda/testing/node/MockServices.html#getClock--">getClock</a></span>()</code>
<div class="block">A <a href="http://docs.oracle.com/javase/8/docs/api/java/time/Clock.html">Clock</a> representing the node's current time. This should be used in preference to directly accessing the
clock so the current time can be controlled during unit testing.</div>
</td>
</tr>
<tr id="i4" class="altColor">
<td class="colFirst"><code><a href="../../../../net/corda/core/node/services/ContractUpgradeService.html" title="type parameter in ContractUpgradeService">ContractUpgradeService</a></code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../../net/corda/testing/node/MockServices.html#getContractUpgradeService--">getContractUpgradeService</a></span>()</code>
<div class="block">The <a href="../../../../net/corda/core/node/services/ContractUpgradeService.html" title="interface in net.corda.core.node.services"><code>interface ContractUpgradeService</code></a> is responsible for securely upgrading contract state objects according to
a specified and mutually agreed (amongst participants) contract version.</div>
</td>
</tr>
<tr id="i5" class="rowColor">
<td class="colFirst"><code>java.lang.ClassLoader</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../../net/corda/testing/node/MockServices.html#getCordappClassloader--">getCordappClassloader</a></span>()</code>
<div class="block">Returns the classloader containing all jar deployed in the 'cordapps' folder.</div>
</td>
</tr>
<tr id="i6" class="altColor">
<td class="colFirst"><code><a href="../../../../net/corda/core/cordapp/CordappProvider.html" title="type parameter in CordappProvider">CordappProvider</a></code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../../net/corda/testing/node/MockServices.html#getCordappProvider--">getCordappProvider</a></span>()</code>
<div class="block">Provides access to anything relating to cordapps including contract attachment resolution and app context</div>
</td>
</tr>
<tr id="i7" class="rowColor">
<td class="colFirst"><code><a href="../../../../net/corda/core/node/services/IdentityService.html" title="type parameter in IdentityService">IdentityService</a></code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../../net/corda/testing/node/MockServices.html#getIdentityService--">getIdentityService</a></span>()</code>
<div class="block">An identity service maintains a directory of parties by their associated distinguished name/public keys and thus</div>
</td>
</tr>
<tr id="i8" class="altColor">
<td class="colFirst"><code><a href="../../../../net/corda/core/node/services/KeyManagementService.html" title="type parameter in KeyManagementService">KeyManagementService</a></code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../../net/corda/testing/node/MockServices.html#getKeyManagementService--">getKeyManagementService</a></span>()</code>
<div class="block">The key management service is responsible for storing and using private keys to sign things. An
implementation of this may, for example, call out to a hardware security module that enforces various
auditing and frequency-of-use requirements.</div>
</td>
</tr>
<tr id="i9" class="rowColor">
<td class="colFirst"><code><a href="../../../../net/corda/core/node/NodeInfo.html" title="type parameter in NodeInfo">NodeInfo</a></code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../../net/corda/testing/node/MockServices.html#getMyInfo--">getMyInfo</a></span>()</code>
<div class="block">The <a href="../../../../net/corda/core/node/NodeInfo.html" title="class in net.corda.core.node"><code>class NodeInfo</code></a> object corresponding to our own entry in the network map.</div>
</td>
</tr>
<tr id="i10" class="altColor">
<td class="colFirst"><code><a href="../../../../net/corda/core/node/services/NetworkMapCache.html" title="type parameter in NetworkMapCache">NetworkMapCache</a></code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../../net/corda/testing/node/MockServices.html#getNetworkMapCache--">getNetworkMapCache</a></span>()</code>
<div class="block">A network map contains lists of nodes on the network along with information about their identity keys, services
they provide and host names or IP addresses where they can be connected to. The cache wraps around a map fetched
from an authoritative service, and adds easy lookup of the data stored within it. Generally it would be initialised
with a specified network map service, which it fetches data from and then subscribes to updates of.</div>
</td>
</tr>
<tr id="i11" class="rowColor">
<td class="colFirst"><code><a href="../../../../net/corda/core/node/NetworkParameters.html" title="type parameter in NetworkParameters">NetworkParameters</a></code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../../net/corda/testing/node/MockServices.html#getNetworkParameters--">getNetworkParameters</a></span>()</code>
<div class="block">Returns the network parameters the node is operating under.</div>
</td>
</tr>
<tr id="i12" class="altColor">
<td class="colFirst"><code><a href="../../../../net/corda/core/node/services/NetworkParametersService.html" title="type parameter in NetworkParametersService">NetworkParametersService</a></code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../../net/corda/testing/node/MockServices.html#getNetworkParametersService--">getNetworkParametersService</a></span>()</code>
<div class="block">Provides access to historical network parameters that are used in transaction resolution.</div>
</td>
</tr>
<tr id="i13" class="rowColor">
<td class="colFirst"><code><a href="../../../../net/corda/core/node/ServicesForResolution.html" title="type parameter in ServicesForResolution">ServicesForResolution</a></code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../../net/corda/testing/node/MockServices.html#getServicesForResolution--">getServicesForResolution</a></span>()</code>&nbsp;</td>
</tr>
<tr id="i14" class="altColor">
<td class="colFirst"><code>net.corda.core.node.services.TransactionVerifierService</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../../net/corda/testing/node/MockServices.html#getTransactionVerifierService--">getTransactionVerifierService</a></span>()</code>
<div class="block">INTERNAL. DO NOT USE.</div>
</td>
</tr>
<tr id="i15" class="rowColor">
<td class="colFirst"><code><a href="../../../../net/corda/core/node/services/TransactionStorage.html" title="type parameter in TransactionStorage">TransactionStorage</a></code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../../net/corda/testing/node/MockServices.html#getValidatedTransactions--">getValidatedTransactions</a></span>()</code>
<div class="block">A map of hash-</div>
</td>
</tr>
<tr id="i16" class="altColor">
<td class="colFirst"><code><a href="../../../../net/corda/core/node/services/VaultService.html" title="type parameter in VaultService">VaultService</a></code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../../net/corda/testing/node/MockServices.html#getVaultService--">getVaultService</a></span>()</code>
<div class="block">The vault service lets you observe, soft lock and add notes to states that involve you or are relevant to your
node in some way. Additionally you may query and track states that correspond to various criteria.</div>
</td>
</tr>
<tr id="i17" class="rowColor">
<td class="colFirst"><code>java.sql.Connection</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../../net/corda/testing/node/MockServices.html#jdbcSession--">jdbcSession</a></span>()</code>
<div class="block">Exposes a JDBC connection (session) object using the currently configured database.
Applications can use this to execute arbitrary SQL queries (native, direct, prepared, callable)
against its Node database tables (including custom contract tables defined by extending
<a href="../../../../net/corda/core/schemas/QueryableState.html" title="interface in net.corda.core.schemas"><code>interface QueryableState</code></a>).</div>
</td>
</tr>
<tr id="i18" class="altColor">
<td class="colFirst"><code><a href="../../../../net/corda/core/contracts/Attachment.html" title="type parameter in Attachment">Attachment</a></code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../../net/corda/testing/node/MockServices.html#loadContractAttachment-stateRef-">loadContractAttachment</a></span>(<a href="../../../../net/corda/core/contracts/StateRef.html" title="type parameter in StateRef">StateRef</a>&nbsp;stateRef)</code>
<div class="block">Returns a dummy Attachment, in context of signature constrains non-downgrade rule this default to contract class version <code>1</code>.</div>
</td>
</tr>
<tr id="i19" class="rowColor">
<td class="colFirst"><code><a href="../../../../net/corda/core/contracts/TransactionState.html" title="type parameter in TransactionState">TransactionState</a>&lt;?&gt;</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../../net/corda/testing/node/MockServices.html#loadState-stateRef-">loadState</a></span>(<a href="../../../../net/corda/core/contracts/StateRef.html" title="type parameter in StateRef">StateRef</a>&nbsp;stateRef)</code>
<div class="block">Given a <a href="../../../../net/corda/core/contracts/StateRef.html" title="class in net.corda.core.contracts"><code>class StateRef</code></a> loads the referenced transaction and looks up the specified output <a href="../../../../net/corda/core/contracts/ContractState.html" title="interface in net.corda.core.contracts"><code>interface ContractState</code></a>.</div>
</td>
</tr>
<tr id="i20" class="altColor">
<td class="colFirst"><code>java.util.Set&lt;net.corda.core.contracts.StateAndRef&gt;</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../../net/corda/testing/node/MockServices.html#loadStates-stateRefs-">loadStates</a></span>(java.util.Set&lt;net.corda.core.contracts.StateRef&gt;&nbsp;stateRefs)</code>
<div class="block">Given a <a href="https://kotlinlang.org/api/latest/jvm/stdlib/kotlin.collections/-set/index.html">Set</a> of <a href="../../../../net/corda/core/contracts/StateRef.html" title="class in net.corda.core.contracts"><code>class StateRef</code></a>'s loads the referenced transaction and looks up the specified output <a href="../../../../net/corda/core/contracts/ContractState.html" title="interface in net.corda.core.contracts"><code>interface ContractState</code></a>.</div>
</td>
</tr>
<tr id="i21" class="rowColor">
<td class="colFirst"><code>static java.util.Properties</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../../net/corda/testing/node/MockServices.html#makeTestDataSourceProperties-nodeName-">makeTestDataSourceProperties</a></span>(java.lang.String&nbsp;nodeName)</code>
<div class="block">Make properties appropriate for creating a DataSource for unit tests.
Defaults configuration of in-memory H2 instance. If 'databaseProvider' system property is set then creates
a config from the relevant config file is present in resources folder (used to parametrize test to run against a remote database).</div>
</td>
</tr>
<tr id="i22" class="altColor">
<td class="colFirst"><code>static kotlin.Pair&lt;net.corda.nodeapi.internal.persistence.CordaPersistence,net.corda.testing.node.MockServices&gt;</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../../net/corda/testing/node/MockServices.html#makeTestDatabaseAndMockServices-cordappPackages-identityService-initialIdentity-networkParameters-moreKeys-">makeTestDatabaseAndMockServices</a></span>(java.util.List&lt;java.lang.String&gt;&nbsp;cordappPackages,
                               <a href="../../../../net/corda/core/node/services/IdentityService.html" title="type parameter in IdentityService">IdentityService</a>&nbsp;identityService,
                               <a href="../../../../net/corda/testing/core/TestIdentity.html" title="type parameter in TestIdentity">TestIdentity</a>&nbsp;initialIdentity,
                               <a href="../../../../net/corda/core/node/NetworkParameters.html" title="type parameter in NetworkParameters">NetworkParameters</a>&nbsp;networkParameters,
                               java.security.KeyPair&nbsp;moreKeys)</code>
<div class="block">Makes database and mock services appropriate for unit tests.</div>
</td>
</tr>
<tr id="i23" class="rowColor">
<td class="colFirst"><code>static kotlin.Pair&lt;net.corda.nodeapi.internal.persistence.CordaPersistence,net.corda.testing.node.MockServices&gt;</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../../net/corda/testing/node/MockServices.html#makeTestDatabaseAndMockServices-cordappPackages-identityService-initialIdentity-moreKeys-">makeTestDatabaseAndMockServices</a></span>(java.util.List&lt;java.lang.String&gt;&nbsp;cordappPackages,
                               <a href="../../../../net/corda/core/node/services/IdentityService.html" title="type parameter in IdentityService">IdentityService</a>&nbsp;identityService,
                               <a href="../../../../net/corda/testing/core/TestIdentity.html" title="type parameter in TestIdentity">TestIdentity</a>&nbsp;initialIdentity,
                               java.security.KeyPair&nbsp;moreKeys)</code>
<div class="block">Makes database and mock services appropriate for unit tests.</div>
</td>
</tr>
<tr id="i24" class="altColor">
<td class="colFirst"><code>static kotlin.Pair&lt;net.corda.nodeapi.internal.persistence.CordaPersistence,net.corda.testing.node.MockServices&gt;</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../../net/corda/testing/node/MockServices.html#makeTestDatabaseAndPersistentServices-cordappPackages-initialIdentity-networkParameters-moreKeys-moreIdentities-">makeTestDatabaseAndPersistentServices</a></span>(java.util.List&lt;java.lang.String&gt;&nbsp;cordappPackages,
                                     <a href="../../../../net/corda/testing/core/TestIdentity.html" title="type parameter in TestIdentity">TestIdentity</a>&nbsp;initialIdentity,
                                     <a href="../../../../net/corda/core/node/NetworkParameters.html" title="type parameter in NetworkParameters">NetworkParameters</a>&nbsp;networkParameters,
                                     java.util.Set&lt;java.security.KeyPair&gt;&nbsp;moreKeys,
                                     java.util.Set&lt;net.corda.core.identity.PartyAndCertificate&gt;&nbsp;moreIdentities)</code>
<div class="block">Makes database and persistent services appropriate for unit tests which require persistence across the vault, identity service
and key managment service.</div>
</td>
</tr>
<tr id="i25" class="rowColor">
<td class="colFirst"><code>static kotlin.Pair&lt;net.corda.nodeapi.internal.persistence.CordaPersistence,net.corda.testing.node.MockServices&gt;</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../../net/corda/testing/node/MockServices.html#makeTestDatabaseAndPersistentServices-cordappPackages-initialIdentity-moreKeys-moreIdentities-">makeTestDatabaseAndPersistentServices</a></span>(java.util.List&lt;java.lang.String&gt;&nbsp;cordappPackages,
                                     <a href="../../../../net/corda/testing/core/TestIdentity.html" title="type parameter in TestIdentity">TestIdentity</a>&nbsp;initialIdentity,
                                     java.util.Set&lt;java.security.KeyPair&gt;&nbsp;moreKeys,
                                     java.util.Set&lt;net.corda.core.identity.PartyAndCertificate&gt;&nbsp;moreIdentities)</code>
<div class="block">Makes database and persistent services appropriate for unit tests which require persistence across the vault, identity service
and key managment service.</div>
</td>
</tr>
<tr id="i26" class="altColor">
<td class="colFirst"><code>void</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../../net/corda/testing/node/MockServices.html#recordTransactions-statesToRecord-txs-">recordTransactions</a></span>(<a href="../../../../net/corda/core/node/StatesToRecord.html" title="type parameter in StatesToRecord">StatesToRecord</a>&nbsp;statesToRecord,
                  java.lang.Iterable&lt;net.corda.core.transactions.SignedTransaction&gt;&nbsp;txs)</code>
<div class="block">Stores the given <a href="../../../../net/corda/core/transactions/SignedTransaction.html" title="class in net.corda.core.transactions"><code>class SignedTransaction</code></a>s in the local transaction storage and then sends them to the vault for
further processing if statesToRecord is not StatesToRecord.NONE.
This is expected to be run within a database transaction.</div>
</td>
</tr>
<tr id="i27" class="rowColor">
<td class="colFirst"><code>java.lang.Void</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../../net/corda/testing/node/MockServices.html#registerUnloadHandler-runOnStop-">registerUnloadHandler</a></span>(kotlin.jvm.functions.Function0&lt;kotlin.Unit&gt;&nbsp;runOnStop)</code>
<div class="block">Allows the registration of a callback that may inform services when the app is shutting down.</div>
</td>
</tr>
<tr id="i28" class="altColor">
<td class="colFirst"><code>void</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../../net/corda/testing/node/MockServices.html#setNetworkParametersService-p-">setNetworkParametersService</a></span>(<a href="../../../../net/corda/core/node/services/NetworkParametersService.html" title="type parameter in NetworkParametersService">NetworkParametersService</a>&nbsp;p)</code>
<div class="block">Provides access to historical network parameters that are used in transaction resolution.</div>
</td>
</tr>
<tr id="i29" class="rowColor">
<td class="colFirst"><code>&lt;T&gt;&nbsp;T</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../../net/corda/testing/node/MockServices.html#withEntityManager-block-">withEntityManager</a></span>(kotlin.jvm.functions.Function1&lt;? super javax.persistence.EntityManager,? extends T&gt;&nbsp;block)</code>
<div class="block">Exposes the Java Persistence API (JPA) to flows via a restricted EntityManager. This method can be used to
persist and query entities which inherit from <a href="#">MappedSchema</a>. This is particularly useful if off-ledger data
needs to be kept in conjunction with on-ledger state data.</div>
</td>
</tr>
<tr id="i30" class="altColor">
<td class="colFirst"><code>void</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../../net/corda/testing/node/MockServices.html#withEntityManager-block-">withEntityManager</a></span>(java.util.function.Consumer&lt;javax.persistence.EntityManager&gt;&nbsp;block)</code>
<div class="block">Exposes the Java Persistence API (JPA) to flows via a restricted EntityManager. This method can be used to
persist and query entities which inherit from <a href="#">MappedSchema</a>. This is particularly useful if off-ledger data
needs to be kept in conjunction with on-ledger state data.</div>
</td>
</tr>
</table>
<ul class="blockList">
<li class="blockList"><a name="methods.inherited.from.class.net.corda.core.node.ServiceHub">
<!--   -->
</a>
<h3>Methods inherited from interface&nbsp;net.corda.core.node.<a href="../../../../net/corda/core/node/ServiceHub.html" title="interface in net.corda.core.node">ServiceHub</a></h3>
<code><a href="../../../../net/corda/core/node/ServiceHub.html#addSignature-signedTransaction-publicKey-">addSignature</a>, <a href="../../../../net/corda/core/node/ServiceHub.html#addSignature-signedTransaction-">addSignature</a>, <a href="../../../../net/corda/core/node/ServiceHub.html#cordaService-type-">cordaService</a>, <a href="../../../../net/corda/core/node/ServiceHub.html#createSignature-signedTransaction-publicKey-">createSignature</a>, <a href="../../../../net/corda/core/node/ServiceHub.html#createSignature-signedTransaction-">createSignature</a>, <a href="../../../../net/corda/core/node/ServiceHub.html#createSignature-filteredTransaction-publicKey-">createSignature</a>, <a href="../../../../net/corda/core/node/ServiceHub.html#createSignature-filteredTransaction-">createSignature</a>, <a href="../../../../net/corda/core/node/ServiceHub.html#getAppContext--">getAppContext</a>, <a href="../../../../net/corda/core/node/ServiceHub.html#getClock--">getClock</a>, <a href="../../../../net/corda/core/node/ServiceHub.html#getContractUpgradeService--">getContractUpgradeService</a>, <a href="../../../../net/corda/core/node/ServiceHub.html#getKeyManagementService--">getKeyManagementService</a>, <a href="../../../../net/corda/core/node/ServiceHub.html#getMyInfo--">getMyInfo</a>, <a href="../../../../net/corda/core/node/ServiceHub.html#getNetworkMapCache--">getNetworkMapCache</a>, <a href="../../../../net/corda/core/node/ServiceHub.html#getValidatedTransactions--">getValidatedTransactions</a>, <a href="../../../../net/corda/core/node/ServiceHub.html#getVaultService--">getVaultService</a>, <a href="../../../../net/corda/core/node/ServiceHub.html#jdbcSession--">jdbcSession</a>, <a href="../../../../net/corda/core/node/ServiceHub.html#recordTransactions-notifyVault-txs-">recordTransactions</a>, <a href="../../../../net/corda/core/node/ServiceHub.html#recordTransactions-notifyVault-first-remaining-">recordTransactions</a>, <a href="../../../../net/corda/core/node/ServiceHub.html#recordTransactions-statesToRecord-txs-">recordTransactions</a>, <a href="../../../../net/corda/core/node/ServiceHub.html#recordTransactions-first-remaining-">recordTransactions</a>, <a href="../../../../net/corda/core/node/ServiceHub.html#recordTransactions-txs-">recordTransactions</a>, <a href="../../../../net/corda/core/node/ServiceHub.html#registerUnloadHandler-runOnStop-">registerUnloadHandler</a>, <a href="../../../../net/corda/core/node/ServiceHub.html#signInitialTransaction-builder-publicKey-">signInitialTransaction</a>, <a href="../../../../net/corda/core/node/ServiceHub.html#signInitialTransaction-builder-">signInitialTransaction</a>, <a href="../../../../net/corda/core/node/ServiceHub.html#signInitialTransaction-builder-signingPubKeys-">signInitialTransaction</a>, <a href="../../../../net/corda/core/node/ServiceHub.html#toStateAndRef-stateRef-">toStateAndRef</a>, <a href="../../../../net/corda/core/node/ServiceHub.html#withEntityManager-block-">withEntityManager</a>, <a href="../../../../net/corda/core/node/ServiceHub.html#withEntityManager-block-">withEntityManager</a></code></li>
</ul>
<ul class="blockList">
<li class="blockList"><a name="methods.inherited.from.class.net.corda.core.node.ServicesForResolution">
<!--   -->
</a>
<h3>Methods inherited from interface&nbsp;net.corda.core.node.<a href="../../../../net/corda/core/node/ServicesForResolution.html" title="interface in net.corda.core.node">ServicesForResolution</a></h3>
<code><a href="../../../../net/corda/core/node/ServicesForResolution.html#getAttachments--">getAttachments</a>, <a href="../../../../net/corda/core/node/ServicesForResolution.html#getCordappProvider--">getCordappProvider</a>, <a href="../../../../net/corda/core/node/ServicesForResolution.html#getIdentityService--">getIdentityService</a>, <a href="../../../../net/corda/core/node/ServicesForResolution.html#getNetworkParameters--">getNetworkParameters</a>, <a href="../../../../net/corda/core/node/ServicesForResolution.html#getNetworkParametersService--">getNetworkParametersService</a>, <a href="../../../../net/corda/core/node/ServicesForResolution.html#loadContractAttachment-stateRef-">loadContractAttachment</a>, <a href="../../../../net/corda/core/node/ServicesForResolution.html#loadState-stateRef-">loadState</a>, <a href="../../../../net/corda/core/node/ServicesForResolution.html#loadStates-stateRefs-">loadStates</a></code></li>
</ul>
</li>
</ul>
</li>
</ul>
</div>
<div class="details">
<ul class="blockList">
<li class="blockList">
<!-- ============ FIELD DETAIL =========== -->
<ul class="blockList">
<li class="blockList"><a name="field.detail">
<!--   -->
</a>
<h3>Field Detail</h3>
<a name="Companion">
<!--   -->
</a>
<ul class="blockListLast">
<li class="blockList">
<h4>Companion</h4>
<pre>public static&nbsp;<a href="../../../../net/corda/testing/node/MockServices.Companion.html" title="type parameter in MockServices.Companion">MockServices.Companion</a> Companion</pre>
</li>
</ul>
</li>
</ul>
<!-- ========= CONSTRUCTOR DETAIL ======== -->
<ul class="blockList">
<li class="blockList"><a name="constructor.detail">
<!--   -->
</a>
<h3>Constructor Detail</h3>
<a name="MockServices-cordappPackages-initialIdentity-identityService-moreKeys-">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>MockServices</h4>
<pre>public&nbsp;MockServices(java.lang.Iterable&lt;java.lang.String&gt;&nbsp;cordappPackages,
                    <a href="../../../../net/corda/testing/core/TestIdentity.html" title="type parameter in TestIdentity">TestIdentity</a>&nbsp;initialIdentity,
                    <a href="../../../../net/corda/core/node/services/IdentityService.html" title="type parameter in IdentityService">IdentityService</a>&nbsp;identityService,
                    java.security.KeyPair&nbsp;moreKeys)</pre>
<div class="block"><p><p>Create a mock <a href="../../../../net/corda/core/node/ServiceHub.html" title="interface in net.corda.core.node"><code>interface ServiceHub</code></a> that looks for app code in the given package names, uses the provided identity service
(you can get one from <a href="../../../../net/corda/testing/node/MockServicesKt.html#makeTestIdentityService-identities-"><code>MockServicesKt.makeTestIdentityService</code></a>) and represents the given identity.</p></p></div>
<dl>
<dt><span class="seeLabel">See Also:</span></dt>
<dd><a href="../../../../net/corda/core/node/ServiceHub.html" title="interface in net.corda.core.node"><code>interface ServiceHub</code></a>, 
<a href="../../../../net/corda/testing/node/MockServicesKt.html#makeTestIdentityService-identities-"><code>MockServicesKt.makeTestIdentityService</code></a></dd>
</dl>
</li>
</ul>
<a name="MockServices-cordappPackages-initialIdentity-moreKeys-">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>MockServices</h4>
<pre>public&nbsp;MockServices(java.lang.Iterable&lt;java.lang.String&gt;&nbsp;cordappPackages,
                    <a href="../../../../net/corda/testing/core/TestIdentity.html" title="type parameter in TestIdentity">TestIdentity</a>&nbsp;initialIdentity,
                    java.security.KeyPair&nbsp;moreKeys)</pre>
<div class="block"><p><p>Create a mock <a href="../../../../net/corda/core/node/ServiceHub.html" title="interface in net.corda.core.node"><code>interface ServiceHub</code></a> that looks for app code in the given package names, uses the provided identity service
(you can get one from <a href="../../../../net/corda/testing/node/MockServicesKt.html#makeTestIdentityService-identities-"><code>MockServicesKt.makeTestIdentityService</code></a>) and represents the given identity.</p></p></div>
<dl>
<dt><span class="seeLabel">See Also:</span></dt>
<dd><a href="../../../../net/corda/core/node/ServiceHub.html" title="interface in net.corda.core.node"><code>interface ServiceHub</code></a>, 
<a href="../../../../net/corda/testing/node/MockServicesKt.html#makeTestIdentityService-identities-"><code>MockServicesKt.makeTestIdentityService</code></a></dd>
</dl>
</li>
</ul>
<a name="MockServices-cordappPackages-initialIdentity-identityService-networkParameters-moreKeys-">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>MockServices</h4>
<pre>public&nbsp;MockServices(java.lang.Iterable&lt;java.lang.String&gt;&nbsp;cordappPackages,
                    <a href="../../../../net/corda/testing/core/TestIdentity.html" title="type parameter in TestIdentity">TestIdentity</a>&nbsp;initialIdentity,
                    <a href="../../../../net/corda/core/node/services/IdentityService.html" title="type parameter in IdentityService">IdentityService</a>&nbsp;identityService,
                    <a href="../../../../net/corda/core/node/NetworkParameters.html" title="type parameter in NetworkParameters">NetworkParameters</a>&nbsp;networkParameters,
                    java.security.KeyPair&nbsp;moreKeys)</pre>
</li>
</ul>
<a name="MockServices-cordappPackages-initialIdentity-identityService-networkParameters-moreKeys-keyManagementService-">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>MockServices</h4>
<pre>public&nbsp;MockServices(java.lang.Iterable&lt;java.lang.String&gt;&nbsp;cordappPackages,
                    <a href="../../../../net/corda/testing/core/TestIdentity.html" title="type parameter in TestIdentity">TestIdentity</a>&nbsp;initialIdentity,
                    <a href="../../../../net/corda/core/node/services/IdentityService.html" title="type parameter in IdentityService">IdentityService</a>&nbsp;identityService,
                    <a href="../../../../net/corda/core/node/NetworkParameters.html" title="type parameter in NetworkParameters">NetworkParameters</a>&nbsp;networkParameters,
                    java.security.KeyPair[]&nbsp;moreKeys,
                    <a href="../../../../net/corda/core/node/services/KeyManagementService.html" title="type parameter in KeyManagementService">KeyManagementService</a>&nbsp;keyManagementService)</pre>
</li>
</ul>
<a name="MockServices-cordappPackages-initialIdentityName-identityService-key-moreKeys-">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>MockServices</h4>
<pre>public&nbsp;MockServices(java.lang.Iterable&lt;java.lang.String&gt;&nbsp;cordappPackages,
                    <a href="../../../../net/corda/core/identity/CordaX500Name.html" title="type parameter in CordaX500Name">CordaX500Name</a>&nbsp;initialIdentityName,
                    <a href="../../../../net/corda/core/node/services/IdentityService.html" title="type parameter in IdentityService">IdentityService</a>&nbsp;identityService,
                    java.security.KeyPair&nbsp;key,
                    java.security.KeyPair&nbsp;moreKeys)</pre>
<div class="block"><p><p>Create a mock <a href="../../../../net/corda/core/node/ServiceHub.html" title="interface in net.corda.core.node"><code>interface ServiceHub</code></a> that looks for app code in the given package names, uses the provided identity service
(you can get one from <a href="../../../../net/corda/testing/node/MockServicesKt.html#makeTestIdentityService-identities-"><code>MockServicesKt.makeTestIdentityService</code></a>) and represents the given identity.</p></p></div>
<dl>
<dt><span class="seeLabel">See Also:</span></dt>
<dd><a href="../../../../net/corda/core/node/ServiceHub.html" title="interface in net.corda.core.node"><code>interface ServiceHub</code></a>, 
<a href="../../../../net/corda/testing/node/MockServicesKt.html#makeTestIdentityService-identities-"><code>MockServicesKt.makeTestIdentityService</code></a></dd>
</dl>
</li>
</ul>
<a name="MockServices-cordappPackages-initialIdentityName-key-moreKeys-">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>MockServices</h4>
<pre>public&nbsp;MockServices(java.lang.Iterable&lt;java.lang.String&gt;&nbsp;cordappPackages,
                    <a href="../../../../net/corda/core/identity/CordaX500Name.html" title="type parameter in CordaX500Name">CordaX500Name</a>&nbsp;initialIdentityName,
                    java.security.KeyPair&nbsp;key,
                    java.security.KeyPair&nbsp;moreKeys)</pre>
<div class="block"><p><p>Create a mock <a href="../../../../net/corda/core/node/ServiceHub.html" title="interface in net.corda.core.node"><code>interface ServiceHub</code></a> that looks for app code in the given package names, uses the provided identity service
(you can get one from <a href="../../../../net/corda/testing/node/MockServicesKt.html#makeTestIdentityService-identities-"><code>MockServicesKt.makeTestIdentityService</code></a>) and represents the given identity.</p></p></div>
<dl>
<dt><span class="seeLabel">See Also:</span></dt>
<dd><a href="../../../../net/corda/core/node/ServiceHub.html" title="interface in net.corda.core.node"><code>interface ServiceHub</code></a>, 
<a href="../../../../net/corda/testing/node/MockServicesKt.html#makeTestIdentityService-identities-"><code>MockServicesKt.makeTestIdentityService</code></a></dd>
</dl>
</li>
</ul>
<a name="MockServices-cordappPackages-initialIdentityName-identityService-">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>MockServices</h4>
<pre>public&nbsp;MockServices(java.lang.Iterable&lt;java.lang.String&gt;&nbsp;cordappPackages,
                    <a href="../../../../net/corda/core/identity/CordaX500Name.html" title="type parameter in CordaX500Name">CordaX500Name</a>&nbsp;initialIdentityName,
                    <a href="../../../../net/corda/core/node/services/IdentityService.html" title="type parameter in IdentityService">IdentityService</a>&nbsp;identityService)</pre>
<div class="block"><p><p>Create a mock <a href="../../../../net/corda/core/node/ServiceHub.html" title="interface in net.corda.core.node"><code>interface ServiceHub</code></a> that can't load CorDapp code, which uses the provided identity service
(you can get one from <a href="../../../../net/corda/testing/node/MockServicesKt.html#makeTestIdentityService-identities-"><code>MockServicesKt.makeTestIdentityService</code></a>) and which represents the given identity.</p></p></div>
<dl>
<dt><span class="seeLabel">See Also:</span></dt>
<dd><a href="../../../../net/corda/core/node/ServiceHub.html" title="interface in net.corda.core.node"><code>interface ServiceHub</code></a>, 
<a href="../../../../net/corda/testing/node/MockServicesKt.html#makeTestIdentityService-identities-"><code>MockServicesKt.makeTestIdentityService</code></a></dd>
</dl>
</li>
</ul>
<a name="MockServices-cordappPackages-initialIdentityName-">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>MockServices</h4>
<pre>public&nbsp;MockServices(java.lang.Iterable&lt;java.lang.String&gt;&nbsp;cordappPackages,
                    <a href="../../../../net/corda/core/identity/CordaX500Name.html" title="type parameter in CordaX500Name">CordaX500Name</a>&nbsp;initialIdentityName)</pre>
<div class="block"><p><p>Create a mock <a href="../../../../net/corda/core/node/ServiceHub.html" title="interface in net.corda.core.node"><code>interface ServiceHub</code></a> that can't load CorDapp code, which uses the provided identity service
(you can get one from <a href="../../../../net/corda/testing/node/MockServicesKt.html#makeTestIdentityService-identities-"><code>MockServicesKt.makeTestIdentityService</code></a>) and which represents the given identity.</p></p></div>
<dl>
<dt><span class="seeLabel">See Also:</span></dt>
<dd><a href="../../../../net/corda/core/node/ServiceHub.html" title="interface in net.corda.core.node"><code>interface ServiceHub</code></a>, 
<a href="../../../../net/corda/testing/node/MockServicesKt.html#makeTestIdentityService-identities-"><code>MockServicesKt.makeTestIdentityService</code></a></dd>
</dl>
</li>
</ul>
<a name="MockServices-cordappPackages-">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>MockServices</h4>
<pre>public&nbsp;MockServices(java.lang.Iterable&lt;java.lang.String&gt;&nbsp;cordappPackages)</pre>
<div class="block"><p><p>Create a mock <a href="../../../../net/corda/core/node/ServiceHub.html" title="interface in net.corda.core.node"><code>interface ServiceHub</code></a> that can't load CorDapp code, and which uses a default service identity.</p></p></div>
<dl>
<dt><span class="seeLabel">See Also:</span></dt>
<dd><a href="../../../../net/corda/core/node/ServiceHub.html" title="interface in net.corda.core.node"><code>interface ServiceHub</code></a></dd>
</dl>
</li>
</ul>
<a name="MockServices-initialIdentityName-identityService-key-moreKeys-">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>MockServices</h4>
<pre>public&nbsp;MockServices(<a href="../../../../net/corda/core/identity/CordaX500Name.html" title="type parameter in CordaX500Name">CordaX500Name</a>&nbsp;initialIdentityName,
                    <a href="../../../../net/corda/core/node/services/IdentityService.html" title="type parameter in IdentityService">IdentityService</a>&nbsp;identityService,
                    java.security.KeyPair&nbsp;key,
                    java.security.KeyPair&nbsp;moreKeys)</pre>
<div class="block"><p><p>Create a mock <a href="../../../../net/corda/core/node/ServiceHub.html" title="interface in net.corda.core.node"><code>interface ServiceHub</code></a> which uses the package of the caller to find CorDapp code. It uses the provided identity service
(you can get one from <a href="../../../../net/corda/testing/node/MockServicesKt.html#makeTestIdentityService-identities-"><code>MockServicesKt.makeTestIdentityService</code></a>) and which represents the given identity.</p></p></div>
<dl>
<dt><span class="seeLabel">See Also:</span></dt>
<dd><a href="../../../../net/corda/core/node/ServiceHub.html" title="interface in net.corda.core.node"><code>interface ServiceHub</code></a>, 
<a href="../../../../net/corda/testing/node/MockServicesKt.html#makeTestIdentityService-identities-"><code>MockServicesKt.makeTestIdentityService</code></a></dd>
</dl>
</li>
</ul>
<a name="MockServices-initialIdentityName-key-moreKeys-">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>MockServices</h4>
<pre>public&nbsp;MockServices(<a href="../../../../net/corda/core/identity/CordaX500Name.html" title="type parameter in CordaX500Name">CordaX500Name</a>&nbsp;initialIdentityName,
                    java.security.KeyPair&nbsp;key,
                    java.security.KeyPair&nbsp;moreKeys)</pre>
<div class="block"><p><p>Create a mock <a href="../../../../net/corda/core/node/ServiceHub.html" title="interface in net.corda.core.node"><code>interface ServiceHub</code></a> which uses the package of the caller to find CorDapp code. It uses the provided identity service
(you can get one from <a href="../../../../net/corda/testing/node/MockServicesKt.html#makeTestIdentityService-identities-"><code>MockServicesKt.makeTestIdentityService</code></a>) and which represents the given identity.</p></p></div>
<dl>
<dt><span class="seeLabel">See Also:</span></dt>
<dd><a href="../../../../net/corda/core/node/ServiceHub.html" title="interface in net.corda.core.node"><code>interface ServiceHub</code></a>, 
<a href="../../../../net/corda/testing/node/MockServicesKt.html#makeTestIdentityService-identities-"><code>MockServicesKt.makeTestIdentityService</code></a></dd>
</dl>
</li>
</ul>
<a name="MockServices-initialIdentityName-identityService-">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>MockServices</h4>
<pre>public&nbsp;MockServices(<a href="../../../../net/corda/core/identity/CordaX500Name.html" title="type parameter in CordaX500Name">CordaX500Name</a>&nbsp;initialIdentityName,
                    <a href="../../../../net/corda/core/node/services/IdentityService.html" title="type parameter in IdentityService">IdentityService</a>&nbsp;identityService)</pre>
<div class="block"><p><p>Create a mock <a href="../../../../net/corda/core/node/ServiceHub.html" title="interface in net.corda.core.node"><code>interface ServiceHub</code></a> which uses the package of the caller to find CorDapp code. It uses the provided identity service
(you can get one from <a href="../../../../net/corda/testing/node/MockServicesKt.html#makeTestIdentityService-identities-"><code>MockServicesKt.makeTestIdentityService</code></a>) and which represents the given identity. It has no keys.</p></p></div>
<dl>
<dt><span class="seeLabel">See Also:</span></dt>
<dd><a href="../../../../net/corda/core/node/ServiceHub.html" title="interface in net.corda.core.node"><code>interface ServiceHub</code></a>, 
<a href="../../../../net/corda/testing/node/MockServicesKt.html#makeTestIdentityService-identities-"><code>MockServicesKt.makeTestIdentityService</code></a></dd>
</dl>
</li>
</ul>
<a name="MockServices-initialIdentityName-">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>MockServices</h4>
<pre>public&nbsp;MockServices(<a href="../../../../net/corda/core/identity/CordaX500Name.html" title="type parameter in CordaX500Name">CordaX500Name</a>&nbsp;initialIdentityName)</pre>
<div class="block"><p><p>Create a mock <a href="../../../../net/corda/core/node/ServiceHub.html" title="interface in net.corda.core.node"><code>interface ServiceHub</code></a> which uses the package of the caller to find CorDapp code. It uses the provided identity service
(you can get one from <a href="../../../../net/corda/testing/node/MockServicesKt.html#makeTestIdentityService-identities-"><code>MockServicesKt.makeTestIdentityService</code></a>) and which represents the given identity. It has no keys.</p></p></div>
<dl>
<dt><span class="seeLabel">See Also:</span></dt>
<dd><a href="../../../../net/corda/core/node/ServiceHub.html" title="interface in net.corda.core.node"><code>interface ServiceHub</code></a>, 
<a href="../../../../net/corda/testing/node/MockServicesKt.html#makeTestIdentityService-identities-"><code>MockServicesKt.makeTestIdentityService</code></a></dd>
</dl>
</li>
</ul>
<a name="MockServices-cordappPackages-initialIdentityName-identityService-networkParameters-">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>MockServices</h4>
<pre>public&nbsp;MockServices(java.util.List&lt;java.lang.String&gt;&nbsp;cordappPackages,
                    <a href="../../../../net/corda/core/identity/CordaX500Name.html" title="type parameter in CordaX500Name">CordaX500Name</a>&nbsp;initialIdentityName,
                    <a href="../../../../net/corda/core/node/services/IdentityService.html" title="type parameter in IdentityService">IdentityService</a>&nbsp;identityService,
                    <a href="../../../../net/corda/core/node/NetworkParameters.html" title="type parameter in NetworkParameters">NetworkParameters</a>&nbsp;networkParameters)</pre>
</li>
</ul>
<a name="MockServices-cordappPackages-initialIdentityName-identityService-networkParameters-key-">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>MockServices</h4>
<pre>public&nbsp;MockServices(java.util.List&lt;java.lang.String&gt;&nbsp;cordappPackages,
                    <a href="../../../../net/corda/core/identity/CordaX500Name.html" title="type parameter in CordaX500Name">CordaX500Name</a>&nbsp;initialIdentityName,
                    <a href="../../../../net/corda/core/node/services/IdentityService.html" title="type parameter in IdentityService">IdentityService</a>&nbsp;identityService,
                    <a href="../../../../net/corda/core/node/NetworkParameters.html" title="type parameter in NetworkParameters">NetworkParameters</a>&nbsp;networkParameters,
                    java.security.KeyPair&nbsp;key)</pre>
</li>
</ul>
<a name="MockServices-firstIdentity-moreIdentities-">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>MockServices</h4>
<pre>public&nbsp;MockServices(<a href="../../../../net/corda/testing/core/TestIdentity.html" title="type parameter in TestIdentity">TestIdentity</a>&nbsp;firstIdentity,
                    net.corda.testing.core.TestIdentity&nbsp;moreIdentities)</pre>
<div class="block"><p><p>A helper constructor that requires at least one test identity to be registered, and which takes the package of
the caller as the package in which to find app code. This is the most convenient constructor and the one that
is normally worth using. The first identity is the identity of this service hub, the rest are identities that
it is aware of.</p></p></div>
</li>
</ul>
<a name="MockServices-firstIdentity-networkParameters-moreIdentities-">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>MockServices</h4>
<pre>public&nbsp;MockServices(<a href="../../../../net/corda/testing/core/TestIdentity.html" title="type parameter in TestIdentity">TestIdentity</a>&nbsp;firstIdentity,
                    <a href="../../../../net/corda/core/node/NetworkParameters.html" title="type parameter in NetworkParameters">NetworkParameters</a>&nbsp;networkParameters,
                    net.corda.testing.core.TestIdentity&nbsp;moreIdentities)</pre>
</li>
</ul>
<a name="MockServices-cordappPackages-firstIdentity-moreIdentities-">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>MockServices</h4>
<pre>public&nbsp;MockServices(java.util.List&lt;java.lang.String&gt;&nbsp;cordappPackages,
                    <a href="../../../../net/corda/testing/core/TestIdentity.html" title="type parameter in TestIdentity">TestIdentity</a>&nbsp;firstIdentity,
                    net.corda.testing.core.TestIdentity&nbsp;moreIdentities)</pre>
</li>
</ul>
<a name="MockServices-cordappPackages-firstIdentity-networkParameters-moreIdentities-">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>MockServices</h4>
<pre>public&nbsp;MockServices(java.util.List&lt;java.lang.String&gt;&nbsp;cordappPackages,
                    <a href="../../../../net/corda/testing/core/TestIdentity.html" title="type parameter in TestIdentity">TestIdentity</a>&nbsp;firstIdentity,
                    <a href="../../../../net/corda/core/node/NetworkParameters.html" title="type parameter in NetworkParameters">NetworkParameters</a>&nbsp;networkParameters,
                    net.corda.testing.core.TestIdentity&nbsp;moreIdentities)</pre>
</li>
</ul>
<a name="MockServices--">
<!--   -->
</a>
<ul class="blockListLast">
<li class="blockList">
<h4>MockServices</h4>
<pre>public&nbsp;MockServices()</pre>
<div class="block"><p><p>Create a mock <a href="../../../../net/corda/core/node/ServiceHub.html" title="interface in net.corda.core.node"><code>interface ServiceHub</code></a> which uses the package of the caller to find CorDapp code. It uses a default service
identity.</p></p></div>
<dl>
<dt><span class="seeLabel">See Also:</span></dt>
<dd><a href="../../../../net/corda/core/node/ServiceHub.html" title="interface in net.corda.core.node"><code>interface ServiceHub</code></a></dd>
</dl>
</li>
</ul>
</li>
</ul>
<!-- ============ METHOD DETAIL ========== -->
<ul class="blockList">
<li class="blockList"><a name="method.detail">
<!--   -->
</a>
<h3>Method Detail</h3>
<a name="getCordappClassloader--">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>getCordappClassloader</h4>
<pre>public&nbsp;java.lang.ClassLoader&nbsp;getCordappClassloader()</pre>
<div class="block"><p><p>Returns the classloader containing all jar deployed in the 'cordapps' folder.</p></p></div>
</li>
</ul>
<a name="recordTransactions-statesToRecord-txs-">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>recordTransactions</h4>
<pre>public&nbsp;void&nbsp;recordTransactions(<a href="../../../../net/corda/core/node/StatesToRecord.html" title="type parameter in StatesToRecord">StatesToRecord</a>&nbsp;statesToRecord,
                               java.lang.Iterable&lt;net.corda.core.transactions.SignedTransaction&gt;&nbsp;txs)</pre>
<div class="block"><p><p>Stores the given <a href="../../../../net/corda/core/transactions/SignedTransaction.html" title="class in net.corda.core.transactions"><code>class SignedTransaction</code></a>s in the local transaction storage and then sends them to the vault for
further processing if statesToRecord is not StatesToRecord.NONE.
This is expected to be run within a database transaction.</p></p></div>
<dl>
<dt><span class="paramLabel">Parameters:</span></dt>
<dd><code>txs</code> - The transactions to record.</dd>
<dd><code>statesToRecord</code> - how the vault should treat the output states of the transaction.</dd>
<dt><span class="seeLabel">See Also:</span></dt>
<dd><a href="../../../../net/corda/core/transactions/SignedTransaction.html" title="class in net.corda.core.transactions"><code>class SignedTransaction</code></a></dd>
</dl>
</li>
</ul>
<a name="getNetworkParameters--">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>getNetworkParameters</h4>
<pre>public&nbsp;<a href="../../../../net/corda/core/node/NetworkParameters.html" title="type parameter in NetworkParameters">NetworkParameters</a>&nbsp;getNetworkParameters()</pre>
<div class="block"><p><p>Returns the network parameters the node is operating under.</p></p></div>
</li>
</ul>
<a name="getAttachments--">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>getAttachments</h4>
<pre>public&nbsp;<a href="../../../../net/corda/testing/services/MockAttachmentStorage.html" title="type parameter in MockAttachmentStorage">MockAttachmentStorage</a>&nbsp;getAttachments()</pre>
<div class="block"><p><p>Provides access to storage of arbitrary JAR files (which may contain only data, no code).</p></p></div>
</li>
</ul>
<a name="getVaultService--">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>getVaultService</h4>
<pre>public&nbsp;<a href="../../../../net/corda/core/node/services/VaultService.html" title="type parameter in VaultService">VaultService</a>&nbsp;getVaultService()</pre>
<div class="block"><p><p>The vault service lets you observe, soft lock and add notes to states that involve you or are relevant to your
node in some way. Additionally you may query and track states that correspond to various criteria.</p></p></div>
</li>
</ul>
<a name="getContractUpgradeService--">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>getContractUpgradeService</h4>
<pre>public&nbsp;<a href="../../../../net/corda/core/node/services/ContractUpgradeService.html" title="type parameter in ContractUpgradeService">ContractUpgradeService</a>&nbsp;getContractUpgradeService()</pre>
<div class="block"><p><p>The <a href="../../../../net/corda/core/node/services/ContractUpgradeService.html" title="interface in net.corda.core.node.services"><code>interface ContractUpgradeService</code></a> is responsible for securely upgrading contract state objects according to
a specified and mutually agreed (amongst participants) contract version.</p></p></div>
<dl>
<dt><span class="seeLabel">See Also:</span></dt>
<dd><a href="../../../../net/corda/core/node/services/ContractUpgradeService.html" title="interface in net.corda.core.node.services"><code>interface ContractUpgradeService</code></a>, 
<a href="../../../../net/corda/core/flows/ContractUpgradeFlow.html" title="class in net.corda.core.flows"><code>class ContractUpgradeFlow</code></a></dd>
</dl>
</li>
</ul>
<a name="getNetworkMapCache--">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>getNetworkMapCache</h4>
<pre>public&nbsp;<a href="../../../../net/corda/core/node/services/NetworkMapCache.html" title="type parameter in NetworkMapCache">NetworkMapCache</a>&nbsp;getNetworkMapCache()</pre>
<div class="block"><p><p>A network map contains lists of nodes on the network along with information about their identity keys, services
they provide and host names or IP addresses where they can be connected to. The cache wraps around a map fetched
from an authoritative service, and adds easy lookup of the data stored within it. Generally it would be initialised
with a specified network map service, which it fetches data from and then subscribes to updates of.</p></p></div>
</li>
</ul>
<a name="getClock--">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>getClock</h4>
<pre>public&nbsp;<a href="../../../../net/corda/testing/node/TestClock.html" title="type parameter in TestClock">TestClock</a>&nbsp;getClock()</pre>
<div class="block"><p><p>A <a href="http://docs.oracle.com/javase/8/docs/api/java/time/Clock.html">Clock</a> representing the node's current time. This should be used in preference to directly accessing the
clock so the current time can be controlled during unit testing.</p></p></div>
<dl>
<dt><span class="seeLabel">See Also:</span></dt>
<dd><a href="http://docs.oracle.com/javase/8/docs/api/java/time/Clock.html">Clock</a></dd>
</dl>
</li>
</ul>
<a name="getMyInfo--">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>getMyInfo</h4>
<pre>public&nbsp;<a href="../../../../net/corda/core/node/NodeInfo.html" title="type parameter in NodeInfo">NodeInfo</a>&nbsp;getMyInfo()</pre>
<div class="block"><p><p>The <a href="../../../../net/corda/core/node/NodeInfo.html" title="class in net.corda.core.node"><code>class NodeInfo</code></a> object corresponding to our own entry in the network map.</p></p></div>
<dl>
<dt><span class="seeLabel">See Also:</span></dt>
<dd><a href="../../../../net/corda/core/node/NodeInfo.html" title="class in net.corda.core.node"><code>class NodeInfo</code></a></dd>
</dl>
</li>
</ul>
<a name="getTransactionVerifierService--">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>getTransactionVerifierService</h4>
<pre>public&nbsp;net.corda.core.node.services.TransactionVerifierService&nbsp;getTransactionVerifierService()</pre>
<div class="block"><p><p>INTERNAL. DO NOT USE.</p></p></div>
</li>
</ul>
<a name="getCordappProvider--">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>getCordappProvider</h4>
<pre>public&nbsp;<a href="../../../../net/corda/core/cordapp/CordappProvider.html" title="type parameter in CordappProvider">CordappProvider</a>&nbsp;getCordappProvider()</pre>
<div class="block"><p><p>Provides access to anything relating to cordapps including contract attachment resolution and app context</p></p></div>
</li>
</ul>
<a name="getNetworkParametersService--">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>getNetworkParametersService</h4>
<pre>public&nbsp;<a href="../../../../net/corda/core/node/services/NetworkParametersService.html" title="type parameter in NetworkParametersService">NetworkParametersService</a>&nbsp;getNetworkParametersService()</pre>
<div class="block"><p><p>Provides access to historical network parameters that are used in transaction resolution.</p></p></div>
</li>
</ul>
<a name="setNetworkParametersService-p-">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>setNetworkParametersService</h4>
<pre>public&nbsp;void&nbsp;setNetworkParametersService(<a href="../../../../net/corda/core/node/services/NetworkParametersService.html" title="type parameter in NetworkParametersService">NetworkParametersService</a>&nbsp;p)</pre>
<div class="block"><p><p>Provides access to historical network parameters that are used in transaction resolution.</p></p></div>
</li>
</ul>
<a name="getServicesForResolution--">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>getServicesForResolution</h4>
<pre>public&nbsp;<a href="../../../../net/corda/core/node/ServicesForResolution.html" title="type parameter in ServicesForResolution">ServicesForResolution</a>&nbsp;getServicesForResolution()</pre>
</li>
</ul>
<a name="cordaService-type-">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>cordaService</h4>
<pre>public&nbsp;&lt;T extends <a href="../../../../net/corda/core/serialization/SerializeAsToken.html" title="type parameter in SerializeAsToken">SerializeAsToken</a>&gt;&nbsp;T&nbsp;cordaService(java.lang.Class&lt;T&gt;&nbsp;type)</pre>
<div class="block"><p><p>Return the singleton instance of the given Corda service type. This is a class that is annotated with
<a href="../../../../net/corda/core/node/services/CordaService.html" title="interface in net.corda.core.node.services"><code>interface CordaService</code></a> and will have automatically been registered by the node.</p></p></div>
<dl>
<dt><span class="throwsLabel">Throws:</span></dt>
<dd> - If type is not annotated with <a href="../../../../net/corda/core/node/services/CordaService.html" title="interface in net.corda.core.node.services"><code>interface CordaService</code></a> or if the instance is not found.</dd>
<dt><span class="seeLabel">See Also:</span></dt>
<dd><a href="../../../../net/corda/core/node/services/CordaService.html" title="interface in net.corda.core.node.services"><code>interface CordaService</code></a></dd>
</dl>
</li>
</ul>
<a name="jdbcSession--">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>jdbcSession</h4>
<pre>public&nbsp;java.sql.Connection&nbsp;jdbcSession()</pre>
<div class="block"><p><p>Exposes a JDBC connection (session) object using the currently configured database.
Applications can use this to execute arbitrary SQL queries (native, direct, prepared, callable)
against its Node database tables (including custom contract tables defined by extending
<a href="../../../../net/corda/core/schemas/QueryableState.html" title="interface in net.corda.core.schemas"><code>interface QueryableState</code></a>).</p></p><p><p><p>When used within a flow, this session automatically forms part of the enclosing flow transaction boundary,
and thus queryable data will include everything committed as of the last checkpoint.</p></p></p></div>
<dl>
<dt><span class="returnLabel">Returns:</span></dt>
<dd>A <a href="http://docs.oracle.com/javase/8/docs/api/java/sql/Connection.html">Connection</a></dd>
<dt><span class="throwsLabel">Throws:</span></dt>
<dd> - if called outside of a transaction.</dd>
<dt><span class="seeLabel">See Also:</span></dt>
<dd><a href="../../../../net/corda/core/schemas/QueryableState.html" title="interface in net.corda.core.schemas"><code>interface QueryableState</code></a></dd>
</dl>
</li>
</ul>
<a name="withEntityManager-block-">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>withEntityManager</h4>
<pre>public&nbsp;&lt;T&gt;&nbsp;T&nbsp;withEntityManager(kotlin.jvm.functions.Function1&lt;? super javax.persistence.EntityManager,? extends T&gt;&nbsp;block)</pre>
<div class="block"><p><p>Exposes the Java Persistence API (JPA) to flows via a restricted EntityManager. This method can be used to
persist and query entities which inherit from <a href="#">MappedSchema</a>. This is particularly useful if off-ledger data
needs to be kept in conjunction with on-ledger state data.</p></p><p><p><p>NOTE: Suspendable flow operations such as send, receive, subFlow and sleep, cannot be called within the lambda.</p></p></p></div>
<dl>
<dt><span class="paramLabel">Parameters:</span></dt>
<dd><code>block</code> - a lambda function with access to an EntityManager.</dd>
<dt><span class="seeLabel">See Also:</span></dt>
<dd><a href="#">MappedSchema</a></dd>
</dl>
</li>
</ul>
<a name="withEntityManager-block-">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>withEntityManager</h4>
<pre>public&nbsp;void&nbsp;withEntityManager(java.util.function.Consumer&lt;javax.persistence.EntityManager&gt;&nbsp;block)</pre>
<div class="block"><p><p>Exposes the Java Persistence API (JPA) to flows via a restricted EntityManager. This method can be used to
persist and query entities which inherit from <a href="#">MappedSchema</a>. This is particularly useful if off-ledger data
needs to be kept in conjunction with on-ledger state data.</p></p><p><p><p>NOTE: Suspendable flow operations such as send, receive, subFlow and sleep, cannot be called within the lambda.</p></p></p></div>
<dl>
<dt><span class="paramLabel">Parameters:</span></dt>
<dd><code>block</code> - a lambda function with access to an EntityManager.</dd>
<dt><span class="seeLabel">See Also:</span></dt>
<dd><a href="#">MappedSchema</a></dd>
</dl>
</li>
</ul>
<a name="registerUnloadHandler-runOnStop-">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>registerUnloadHandler</h4>
<pre>public&nbsp;java.lang.Void&nbsp;registerUnloadHandler(kotlin.jvm.functions.Function0&lt;kotlin.Unit&gt;&nbsp;runOnStop)</pre>
<div class="block"><p><p>Allows the registration of a callback that may inform services when the app is shutting down.</p></p><p><p><p>The intent is to allow the cleaning up of resources - e.g. releasing ports.</p><p>You should not rely on this to clean up executing flows - that's what quasar is for.</p><p>Please note that the shutdown handler is not guaranteed to be called. In production the node process may crash,
be killed by the operating system and other forms of fatal termination may occur that result in this code never
running. So you should use this functionality only for unit/integration testing or for code that can optimise
this shutdown e.g. by cleaning up things that would otherwise trigger a slow recovery process next time the
node starts.</p></p></p></div>
</li>
</ul>
<a name="addMockCordapp-contractClassName-">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>addMockCordapp</h4>
<pre>public&nbsp;void&nbsp;addMockCordapp(java.lang.String&nbsp;contractClassName)</pre>
<div class="block"><p><p>Add the given package name to the list of packages which will be scanned for cordapp contract verification code</p></p></div>
</li>
</ul>
<a name="loadState-stateRef-">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>loadState</h4>
<pre>public&nbsp;<a href="../../../../net/corda/core/contracts/TransactionState.html" title="type parameter in TransactionState">TransactionState</a>&lt;?&gt;&nbsp;loadState(<a href="../../../../net/corda/core/contracts/StateRef.html" title="type parameter in StateRef">StateRef</a>&nbsp;stateRef)</pre>
<div class="block"><p><p>Given a <a href="../../../../net/corda/core/contracts/StateRef.html" title="class in net.corda.core.contracts"><code>class StateRef</code></a> loads the referenced transaction and looks up the specified output <a href="../../../../net/corda/core/contracts/ContractState.html" title="interface in net.corda.core.contracts"><code>interface ContractState</code></a>.</p></p><p><p><p><em>WARNING</em> Do not use this method unless you really only want a single state - any batch loading should
go through <a href="../../../../net/corda/core/node/ServicesForResolution.html#loadStates-stateRefs-"><code>ServicesForResolution.loadStates</code></a> as repeatedly calling <a href="../../../../net/corda/core/node/ServicesForResolution.html#loadState-stateRef-"><code>ServicesForResolution.loadState</code></a> can lead to repeat deserialsiation work and
severe performance degradation.</p></p></p></div>
<dl>
<dt><span class="throwsLabel">Throws:</span></dt>
<dd> - if stateRef points to a non-existent transaction.</dd>
<dt><span class="seeLabel">See Also:</span></dt>
<dd><a href="../../../../net/corda/core/contracts/StateRef.html" title="class in net.corda.core.contracts"><code>class StateRef</code></a>, 
<a href="../../../../net/corda/core/contracts/ContractState.html" title="interface in net.corda.core.contracts"><code>interface ContractState</code></a>, 
<a href="../../../../net/corda/core/node/ServicesForResolution.html#loadStates-stateRefs-"><code>ServicesForResolution.loadStates</code></a>, 
<a href="../../../../net/corda/core/node/ServicesForResolution.html#loadState-stateRef-"><code>ServicesForResolution.loadState</code></a></dd>
</dl>
</li>
</ul>
<a name="loadStates-stateRefs-">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>loadStates</h4>
<pre>public&nbsp;java.util.Set&lt;net.corda.core.contracts.StateAndRef&gt;&nbsp;loadStates(java.util.Set&lt;net.corda.core.contracts.StateRef&gt;&nbsp;stateRefs)</pre>
<div class="block"><p><p>Given a <a href="https://kotlinlang.org/api/latest/jvm/stdlib/kotlin.collections/-set/index.html">Set</a> of <a href="../../../../net/corda/core/contracts/StateRef.html" title="class in net.corda.core.contracts"><code>class StateRef</code></a>'s loads the referenced transaction and looks up the specified output <a href="../../../../net/corda/core/contracts/ContractState.html" title="interface in net.corda.core.contracts"><code>interface ContractState</code></a>.</p></p></div>
<dl>
<dt><span class="throwsLabel">Throws:</span></dt>
<dd> - if <a href="#">stateRef</a> points to a non-existent transaction.</dd>
<dt><span class="seeLabel">See Also:</span></dt>
<dd><a href="https://kotlinlang.org/api/latest/jvm/stdlib/kotlin.collections/-set/index.html">Set</a>, 
<a href="../../../../net/corda/core/contracts/StateRef.html" title="class in net.corda.core.contracts"><code>class StateRef</code></a>, 
<a href="../../../../net/corda/core/contracts/ContractState.html" title="interface in net.corda.core.contracts"><code>interface ContractState</code></a></dd>
</dl>
</li>
</ul>
<a name="loadContractAttachment-stateRef-">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>loadContractAttachment</h4>
<pre>public&nbsp;<a href="../../../../net/corda/core/contracts/Attachment.html" title="type parameter in Attachment">Attachment</a>&nbsp;loadContractAttachment(<a href="../../../../net/corda/core/contracts/StateRef.html" title="type parameter in StateRef">StateRef</a>&nbsp;stateRef)</pre>
<div class="block"><p><p>Returns a dummy Attachment, in context of signature constrains non-downgrade rule this default to contract class version <code>1</code>.</p></p></div>
</li>
</ul>
<a name="getValidatedTransactions--">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>getValidatedTransactions</h4>
<pre>public&nbsp;<a href="../../../../net/corda/core/node/services/TransactionStorage.html" title="type parameter in TransactionStorage">TransactionStorage</a>&nbsp;getValidatedTransactions()</pre>
<div class="block"><p>A map of hash-</p><p><p>>tx where tx has been signature/contract validated and the states are known to be correct.The signatures aren't technically needed after that point, but we keep them around so that we can relaythe transaction data to other nodes that need it.</p></p></div>
</li>
</ul>
<a name="getIdentityService--">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>getIdentityService</h4>
<pre>public&nbsp;<a href="../../../../net/corda/core/node/services/IdentityService.html" title="type parameter in IdentityService">IdentityService</a>&nbsp;getIdentityService()</pre>
<div class="block"><p>An identity service maintains a directory of parties by their associated distinguished name/public keys and thus</p><p><p>supports lookup of a party given its key, or name. The service also manages the certificates linking confidentialidentities back to the well known identity (i.e. the identity in the network map) of a party.</p></p></div>
</li>
</ul>
<a name="getKeyManagementService--">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>getKeyManagementService</h4>
<pre>public&nbsp;<a href="../../../../net/corda/core/node/services/KeyManagementService.html" title="type parameter in KeyManagementService">KeyManagementService</a>&nbsp;getKeyManagementService()</pre>
<div class="block"><p><p>The key management service is responsible for storing and using private keys to sign things. An
implementation of this may, for example, call out to a hardware security module that enforces various
auditing and frequency-of-use requirements.</p></p><p><p><p>You don't normally need to use this directly. If you have a <a href="../../../../net/corda/core/transactions/TransactionBuilder.html" title="class in net.corda.core.transactions"><code>class TransactionBuilder</code></a> and wish to sign it to
get a <a href="../../../../net/corda/core/transactions/SignedTransaction.html" title="class in net.corda.core.transactions"><code>class SignedTransaction</code></a>, look at signInitialTransaction.</p></p></p></div>
<dl>
<dt><span class="seeLabel">See Also:</span></dt>
<dd><a href="../../../../net/corda/core/transactions/TransactionBuilder.html" title="class in net.corda.core.transactions"><code>class TransactionBuilder</code></a>, 
<a href="../../../../net/corda/core/transactions/SignedTransaction.html" title="class in net.corda.core.transactions"><code>class SignedTransaction</code></a></dd>
</dl>
</li>
</ul>
<a name="makeTestDataSourceProperties-nodeName-">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>makeTestDataSourceProperties</h4>
<pre>public static&nbsp;java.util.Properties&nbsp;makeTestDataSourceProperties(java.lang.String&nbsp;nodeName)</pre>
<div class="block"><p><p>Make properties appropriate for creating a DataSource for unit tests.
Defaults configuration of in-memory H2 instance. If 'databaseProvider' system property is set then creates
a config from the relevant config file is present in resources folder (used to parametrize test to run against a remote database).</p></p></div>
<dl>
<dt><span class="paramLabel">Parameters:</span></dt>
<dd><code>nodeName</code> - Reflects the "instance" of the in-memory database or database username/schema.
Defaults to a random string.</dd>
</dl>
</li>
</ul>
<a name="makeTestDatabaseAndMockServices-cordappPackages-identityService-initialIdentity-networkParameters-moreKeys-">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>makeTestDatabaseAndMockServices</h4>
<pre>public static&nbsp;kotlin.Pair&lt;net.corda.nodeapi.internal.persistence.CordaPersistence,net.corda.testing.node.MockServices&gt;&nbsp;makeTestDatabaseAndMockServices(java.util.List&lt;java.lang.String&gt;&nbsp;cordappPackages,
                                                                                                                                                       <a href="../../../../net/corda/core/node/services/IdentityService.html" title="type parameter in IdentityService">IdentityService</a>&nbsp;identityService,
                                                                                                                                                       <a href="../../../../net/corda/testing/core/TestIdentity.html" title="type parameter in TestIdentity">TestIdentity</a>&nbsp;initialIdentity,
                                                                                                                                                       <a href="../../../../net/corda/core/node/NetworkParameters.html" title="type parameter in NetworkParameters">NetworkParameters</a>&nbsp;networkParameters,
                                                                                                                                                       java.security.KeyPair&nbsp;moreKeys)</pre>
<div class="block"><p><p>Makes database and mock services appropriate for unit tests.</p></p></div>
<dl>
<dt><span class="paramLabel">Parameters:</span></dt>
<dd><code>cordappPackages</code> - A <a href="https://kotlinlang.org/api/latest/jvm/stdlib/kotlin.collections/-list/index.html">List</a> of cordapp packages to scan for any cordapp code, e.g. contract verification code, flows and services.</dd>
<dd><code>identityService</code> - An instance of <a href="../../../../net/corda/core/node/services/IdentityService.html" title="interface in net.corda.core.node.services"><code>interface IdentityService</code></a>, see <a href="../../../../net/corda/testing/node/MockServicesKt.html#makeTestIdentityService-identities-"><code>MockServicesKt.makeTestIdentityService</code></a>.</dd>
<dd><code>initialIdentity</code> - The first (typically sole) identity the services will represent.</dd>
<dd><code>moreKeys</code> - A list of additional <a href="http://docs.oracle.com/javase/8/docs/api/java/security/KeyPair.html">KeyPair</a> instances to be used by <a href="../../../../net/corda/testing/node/MockServices.html" title="class in net.corda.testing.node"><code>class MockServices</code></a>.</dd>
<dt><span class="returnLabel">Returns:</span></dt>
<dd>A pair where the first element is the instance of CordaPersistence and the second is <a href="../../../../net/corda/testing/node/MockServices.html" title="class in net.corda.testing.node"><code>class MockServices</code></a>.</dd>
</dl>
</li>
</ul>
<a name="makeTestDatabaseAndMockServices-cordappPackages-identityService-initialIdentity-moreKeys-">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>makeTestDatabaseAndMockServices</h4>
<pre>public static&nbsp;kotlin.Pair&lt;net.corda.nodeapi.internal.persistence.CordaPersistence,net.corda.testing.node.MockServices&gt;&nbsp;makeTestDatabaseAndMockServices(java.util.List&lt;java.lang.String&gt;&nbsp;cordappPackages,
                                                                                                                                                       <a href="../../../../net/corda/core/node/services/IdentityService.html" title="type parameter in IdentityService">IdentityService</a>&nbsp;identityService,
                                                                                                                                                       <a href="../../../../net/corda/testing/core/TestIdentity.html" title="type parameter in TestIdentity">TestIdentity</a>&nbsp;initialIdentity,
                                                                                                                                                       java.security.KeyPair&nbsp;moreKeys)</pre>
<div class="block"><p><p>Makes database and mock services appropriate for unit tests.</p></p></div>
<dl>
<dt><span class="paramLabel">Parameters:</span></dt>
<dd><code>cordappPackages</code> - A <a href="https://kotlinlang.org/api/latest/jvm/stdlib/kotlin.collections/-list/index.html">List</a> of cordapp packages to scan for any cordapp code, e.g. contract verification code, flows and services.</dd>
<dd><code>identityService</code> - An instance of <a href="../../../../net/corda/core/node/services/IdentityService.html" title="interface in net.corda.core.node.services"><code>interface IdentityService</code></a>, see <a href="../../../../net/corda/testing/node/MockServicesKt.html#makeTestIdentityService-identities-"><code>MockServicesKt.makeTestIdentityService</code></a>.</dd>
<dd><code>initialIdentity</code> - The first (typically sole) identity the services will represent.</dd>
<dd><code>moreKeys</code> - A list of additional <a href="http://docs.oracle.com/javase/8/docs/api/java/security/KeyPair.html">KeyPair</a> instances to be used by <a href="../../../../net/corda/testing/node/MockServices.html" title="class in net.corda.testing.node"><code>class MockServices</code></a>.</dd>
<dt><span class="returnLabel">Returns:</span></dt>
<dd>A pair where the first element is the instance of CordaPersistence and the second is <a href="../../../../net/corda/testing/node/MockServices.html" title="class in net.corda.testing.node"><code>class MockServices</code></a>.</dd>
</dl>
</li>
</ul>
<a name="makeTestDatabaseAndPersistentServices-cordappPackages-initialIdentity-networkParameters-moreKeys-moreIdentities-">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>makeTestDatabaseAndPersistentServices</h4>
<pre>public static&nbsp;kotlin.Pair&lt;net.corda.nodeapi.internal.persistence.CordaPersistence,net.corda.testing.node.MockServices&gt;&nbsp;makeTestDatabaseAndPersistentServices(java.util.List&lt;java.lang.String&gt;&nbsp;cordappPackages,
                                                                                                                                                             <a href="../../../../net/corda/testing/core/TestIdentity.html" title="type parameter in TestIdentity">TestIdentity</a>&nbsp;initialIdentity,
                                                                                                                                                             <a href="../../../../net/corda/core/node/NetworkParameters.html" title="type parameter in NetworkParameters">NetworkParameters</a>&nbsp;networkParameters,
                                                                                                                                                             java.util.Set&lt;java.security.KeyPair&gt;&nbsp;moreKeys,
                                                                                                                                                             java.util.Set&lt;net.corda.core.identity.PartyAndCertificate&gt;&nbsp;moreIdentities)</pre>
<div class="block"><p><p>Makes database and persistent services appropriate for unit tests which require persistence across the vault, identity service
and key managment service.</p></p></div>
<dl>
<dt><span class="paramLabel">Parameters:</span></dt>
<dd><code>cordappPackages</code> - A <a href="https://kotlinlang.org/api/latest/jvm/stdlib/kotlin.collections/-list/index.html">List</a> of cordapp packages to scan for any cordapp code, e.g. contract verification code, flows and services.</dd>
<dd><code>initialIdentity</code> - The first (typically sole) identity the services will represent.</dd>
<dd><code>moreKeys</code> - A list of additional <a href="http://docs.oracle.com/javase/8/docs/api/java/security/KeyPair.html">KeyPair</a> instances to be used by <a href="../../../../net/corda/testing/node/MockServices.html" title="class in net.corda.testing.node"><code>class MockServices</code></a>.</dd>
<dd><code>moreIdentities</code> - A list of additional <a href="http://docs.oracle.com/javase/8/docs/api/java/security/KeyPair.html">KeyPair</a> instances to be used by <a href="../../../../net/corda/testing/node/MockServices.html" title="class in net.corda.testing.node"><code>class MockServices</code></a>.</dd>
<dt><span class="returnLabel">Returns:</span></dt>
<dd>A pair where the first element is the instance of CordaPersistence and the second is <a href="../../../../net/corda/testing/node/MockServices.html" title="class in net.corda.testing.node"><code>class MockServices</code></a>.</dd>
</dl>
</li>
</ul>
<a name="makeTestDatabaseAndPersistentServices-cordappPackages-initialIdentity-moreKeys-moreIdentities-">
<!--   -->
</a>
<ul class="blockListLast">
<li class="blockList">
<h4>makeTestDatabaseAndPersistentServices</h4>
<pre>public static&nbsp;kotlin.Pair&lt;net.corda.nodeapi.internal.persistence.CordaPersistence,net.corda.testing.node.MockServices&gt;&nbsp;makeTestDatabaseAndPersistentServices(java.util.List&lt;java.lang.String&gt;&nbsp;cordappPackages,
                                                                                                                                                             <a href="../../../../net/corda/testing/core/TestIdentity.html" title="type parameter in TestIdentity">TestIdentity</a>&nbsp;initialIdentity,
                                                                                                                                                             java.util.Set&lt;java.security.KeyPair&gt;&nbsp;moreKeys,
                                                                                                                                                             java.util.Set&lt;net.corda.core.identity.PartyAndCertificate&gt;&nbsp;moreIdentities)</pre>
<div class="block"><p><p>Makes database and persistent services appropriate for unit tests which require persistence across the vault, identity service
and key managment service.</p></p></div>
<dl>
<dt><span class="paramLabel">Parameters:</span></dt>
<dd><code>cordappPackages</code> - A <a href="https://kotlinlang.org/api/latest/jvm/stdlib/kotlin.collections/-list/index.html">List</a> of cordapp packages to scan for any cordapp code, e.g. contract verification code, flows and services.</dd>
<dd><code>initialIdentity</code> - The first (typically sole) identity the services will represent.</dd>
<dd><code>moreKeys</code> - A list of additional <a href="http://docs.oracle.com/javase/8/docs/api/java/security/KeyPair.html">KeyPair</a> instances to be used by <a href="../../../../net/corda/testing/node/MockServices.html" title="class in net.corda.testing.node"><code>class MockServices</code></a>.</dd>
<dd><code>moreIdentities</code> - A list of additional <a href="http://docs.oracle.com/javase/8/docs/api/java/security/KeyPair.html">KeyPair</a> instances to be used by <a href="../../../../net/corda/testing/node/MockServices.html" title="class in net.corda.testing.node"><code>class MockServices</code></a>.</dd>
<dt><span class="returnLabel">Returns:</span></dt>
<dd>A pair where the first element is the instance of CordaPersistence and the second is <a href="../../../../net/corda/testing/node/MockServices.html" title="class in net.corda.testing.node"><code>class MockServices</code></a>.</dd>
</dl>
</li>
</ul>
</li>
</ul>
</li>
</ul>
</div>
</div>
<!-- ========= END OF CLASS DATA ========= -->
<!-- ======= START OF BOTTOM NAVBAR ====== -->
<div class="bottomNav"><a name="navbar.bottom">
<!--   -->
</a>
<div class="skipNav"><a href="#skip.navbar.bottom" title="Skip navigation links">Skip navigation links</a></div>
<a name="navbar.bottom.firstrow">
<!--   -->
</a>
<ul class="navList" title="Navigation">
<li><a href="../../../../overview-summary.html">Overview</a></li>
<li><a href="package-summary.html">Package</a></li>
<li class="navBarCell1Rev">Class</li>
<li><a href="package-tree.html">Tree</a></li>
<li><a href="../../../../deprecated-list.html">Deprecated</a></li>
<li><a href="../../../../index-all.html">Index</a></li>
<li><a href="../../../../help-doc.html">Help</a></li>
</ul>
</div>
<div class="subNav">
<ul class="navList">
<li><a href="../../../../net/corda/testing/node/MockNodeParameters.html" title="class in net.corda.testing.node"><span class="typeNameLink">Prev&nbsp;Class</span></a></li>
<li><a href="../../../../net/corda/testing/node/MockServicesKt.html" title="class in net.corda.testing.node"><span class="typeNameLink">Next&nbsp;Class</span></a></li>
</ul>
<ul class="navList">
<li><a href="../../../../index.html?net/corda/testing/node/MockServices.html" target="_top">Frames</a></li>
<li><a href="MockServices.html" target="_top">No&nbsp;Frames</a></li>
</ul>
<ul class="navList" id="allclasses_navbar_bottom">
<li><a href="../../../../allclasses-noframe.html">All&nbsp;Classes</a></li>
</ul>
<div>
<script type="text/javascript"><!--
  allClassesLink = document.getElementById("allclasses_navbar_bottom");
  if(window==top) {
    allClassesLink.style.display = "block";
  }
  else {
    allClassesLink.style.display = "none";
  }
  //-->
</script>
</div>
<div>
<ul class="subNavList">
<li>Summary:&nbsp;</li>
<li><a href="#nested.class.summary">Nested</a>&nbsp;|&nbsp;</li>
<li><a href="#field.summary">Field</a>&nbsp;|&nbsp;</li>
<li><a href="#constructor.summary">Constr</a>&nbsp;|&nbsp;</li>
<li><a href="#method.summary">Method</a></li>
</ul>
<ul class="subNavList">
<li>Detail:&nbsp;</li>
<li><a href="#field.detail">Field</a>&nbsp;|&nbsp;</li>
<li><a href="#constructor.detail">Constr</a>&nbsp;|&nbsp;</li>
<li><a href="#method.detail">Method</a></li>
</ul>
</div>
<a name="skip.navbar.bottom">
<!--   -->
</a></div>
<!-- ======== END OF BOTTOM NAVBAR ======= -->

<style>
    @import url("https://fonts.googleapis.com/css?family=Source+Sans+Pro:300,400,500,600");
    #cookies-eu-banner {
        background-color: rgba(83, 88, 95, 0.9);
        border-radius: 3px;
        color: #fff;
        font-family: 'Source Sans Pro', sans-serif;
        font-size: 13px;
        font-weight: 400;
        left: 3px;
        position: fixed;
        padding: 6px;
        right: 3px;
        text-align: center;
        top: 100px;
        z-index: 1000;
    }
    
    #cookies-eu-banner h3,
    #cookies-eu-banner p {
        color: #fff;
        font-size: 18px;
        letter-spacing: 0;
    }
    
    #cookies-eu-banner h3 {
        font-size: 24px;
        font-style: normal;
        font-weight: 400;
        line-height: 1.2;
        margin: 9px 0 0;
        text-transform: uppercase;
    }
    
    #cookies-eu-banner p {
        margin-bottom: 10px;
        padding: 8px 36px 0;
        text-align: justify;
        line-height: 1.4em;
    }
    
    #cookies-eu-banner fieldset {
        min-width: 0;
        padding: 0;
        margin: 0;
        border: 0;
    }
    
    #cookies-eu-banner legend {
        color: inherit;
        display: block;
        font-size: 18px;
        line-height: inherit;
        max-width: 100%;
        margin-bottom: 16px;
        padding: 0;
        white-space: normal;
        width: 100%;
    }
    
    #cookies-eu-banner a {
        color: #62AAF1;
    }
    
    #cookies-eu-banner .cookies-button-group {
        display: flex;
        justify-content: center;
    }
    
    #cookies-eu-accept,
    #cookies-eu-accept-all {
        background-color: #ec1d24;
        border: none;
        border-radius: 6px;
        color: #fff;
        font-size: 12px;
        font-weight: 600;
        margin: 0 10px 10px;
        max-height: 40px;
        height: 40px;
        line-height: 1.1;
        text-decoration: none;
        width: 150px;
    }
    
    .cookies-checkbox {
        display: inline-block;
        margin: 5px 10px;
    }
    
    .cookies-checkbox label {
        font-size: 16px;
        margin-left: 3px;
    }
    
    @media screen and (min-width: 768px) {
        #cookies-eu-banner {
            bottom: 5px;
            top: inherit;
        }
        #cookies-eu-accept,
        #cookies-eu-accept-all {
            font-size: 14px;
        }
    }
</style>
<div id="cookies-eu-banner" style="display: none;">
    <h3 style="text-transform:none">Your privacy</h3>
    <div class='cookie-flex'>
        <p>
            We use cookies to improve your experience on our site, and to help us understand how people use our documentation. For more detailed information, see our <a href="https://www.r3.com/privacy-policy/">privacy policy</a> and <a href="#">cookie declaration</a>.
        </p>
        <form id='cookie-consent-form'>
            <fieldset>
                <legend>
                    Please select from the following options to continue to our site.
                </legend>
                <div class='cookies-button-group'>
                    <button id="cookies-eu-accept" type="button">
                      Allow cookies selected
                    </button>
                    <button id="cookies-eu-accept-all" type="button">
                      Allow all cookies
                    </button>
                    <span class='cookies-checkbox'>
                      <input
                      type="checkbox"
                      id="necessary"
                      name="necessary"
                      autocomplete="off"
                      checked
                      disabled />
                        <input
                        name="necessary"
                        type="hidden"
                        value="on"/>
                        <label for="necessary">Necessary</label>
                    </span>
                    <span class='cookies-checkbox'>
                      <input
                      type="checkbox"
                      id="preferences"
                      name="preferences"
                      autocomplete="off" />
                      <label for="preferences">Preferences</label>
                    </span>
                    <span class='cookies-checkbox'>
                      <input
                      type="checkbox"
                      id="statistics"
                      name="statistics"
                      autocomplete="off" />
                      <label for="statistics">Statistics</label>
                    </span>
                    <span class='cookies-checkbox'>
                      <input
                      type="checkbox"
                      id="marketing"
                      name="marketing"
                      autocomplete="off" />
                      <label for="marketing">Marketing</label>
                    </span>
                </div>
            </fieldset>
        </form>
    </div>
</div>
<script class='api-keys'>
    var gaKey = 'UA-87760032-1';
    var algolia_appId = "UX2KMUWFAL";
    var algolia_apiKey = "1fe3367db02689b4aeebc59efad5abaf";
    var algolia_index = "docs.corda.net";
</script>
<script class='cookies-eu-banner'>
    ! function(root, factory) {
        "use strict";
        "function" == typeof define && define.amd ? define([], factory) : "object" == typeof exports ? module.exports = factory() : root.CookiesEuBanner = factory()
    }(window, function() {
        "use strict";
        var document = window.document,
            CookiesEuBanner = function(launchFunction, waitAccept, useLocalStorage, undefined) {
                if (!(this instanceof CookiesEuBanner)) return new CookiesEuBanner(launchFunction);
                this.cookieTimeout = 33696e6, this.bots = /bot|crawler|spider|crawling/i, this.cookieName = "hasConsent", this.trackingCookiesNames = ["__utma", "__utmb", "__utmc", "__utmt", "__utmv", "__utmz", "_ga", "_gat", "_gid"], this.launchFunction = launchFunction, this.waitAccept = waitAccept || !1, this.useLocalStorage = useLocalStorage || !1, this.init()
            };
        return CookiesEuBanner.prototype = {
            init: function() {
                var isBot = this.bots.test(navigator.userAgent);
                navigator.doNotTrack || navigator.msDoNotTrack || window.doNotTrack;
                return isBot || !1 === this.hasConsent() ? (this.removeBanner(0), !1) : !0 === this.hasConsent() ? (this.launchFunction(), !0) : (this.showBanner(), void(this.waitAccept || this.setConsent(!0)))
            },
            showBanner: function() {
                var _this = this,
                    getElementById = document.getElementById.bind(document),
                    banner = getElementById("cookies-eu-banner"),
                    rejectButton = getElementById("cookies-eu-reject"),
                    acceptButton = getElementById("cookies-eu-accept"),
                    moreLink = getElementById("cookies-eu-more"),
                    waitRemove = void 0 === banner.dataset.waitRemove ? 0 : parseInt(banner.dataset.waitRemove),
                    addClickListener = this.addClickListener,
                    removeBanner = _this.removeBanner.bind(_this, waitRemove);
                banner.style.display = "block", moreLink && addClickListener(moreLink, function() {
                    _this.deleteCookie(_this.cookieName)
                }), acceptButton && addClickListener(acceptButton, function() {
                    removeBanner(), _this.setConsent(!0), _this.launchFunction()
                }), rejectButton && addClickListener(rejectButton, function() {
                    removeBanner(), _this.setConsent(!1), _this.trackingCookiesNames.map(_this.deleteCookie)
                })
            },
            setConsent: function(consent) {
                if (this.useLocalStorage) return localStorage.setItem(this.cookieName, consent);
                this.setCookie(this.cookieName, consent)
            },
            hasConsent: function() {
                function isCookieSetTo(value) {
                    return -1 < document.cookie.indexOf(cookieName + "=" + value) || localStorage.getItem(cookieName) === value
                }
                var cookieName = this.cookieName;
                return !!isCookieSetTo("true") || !isCookieSetTo("false") && null
            },
            setCookie: function(name, value) {
                var date = new Date;
                date.setTime(date.getTime() + this.cookieTimeout), document.cookie = name + "=" + value + ";SameSite=Strict;expires=" + date.toGMTString() + ";path=/"
            },
            deleteCookie: function(name) {
                var hostname = document.location.hostname.replace(/^www\./, ""),
                    commonSuffix = "; expires=Thu, 01-Jan-1970 00:00:01 GMT; path=/";
                document.cookie = name + "=; domain=." + hostname + commonSuffix, document.cookie = name + "=" + commonSuffix
            },
            addClickListener: function(DOMElement, callback) {
                if (DOMElement.attachEvent) return DOMElement.attachEvent("onclick", callback);
                DOMElement.addEventListener("click", callback)
            },
            removeBanner: function(wait) {
                setTimeout(function() {
                    var banner = document.getElementById("cookies-eu-banner");
                    banner && banner.parentNode && banner.parentNode.removeChild(banner)
                }, wait)
            }
        }, CookiesEuBanner
    });
</script>
<script class='google-analytics'>
    function googleAnalytics() {
        var i, s, o, r, a, m;
        i = window, s = document, o = "script", r = "ga", i.GoogleAnalyticsObject = r, i.ga = i.ga || function() {
            (i.ga.q = i.ga.q || []).push(arguments)
        }, i.ga.l = +new Date, a = s.createElement(o), m = s.getElementsByTagName(o)[0], a.async = 1, a.src = "//www.google-analytics.com/analytics.js", m.parentNode.insertBefore(a, m), window.ga("create", "UA-87760032-1", "auto"), window.ga("send", "pageview")
    }
</script>
<script class='docSearchInit'>
    function docSearchInit() {
        var algoliaOptions;
        document.querySelector("#search-input") && (algoliaOptions = {
            hitsPerPage: 5,
            facetFilters: facetFilters
        }, /404.html/.test(window.location.pathname) && delete algoliaOptions.facetFilters, window.docsearch({
            appId: algolia_appId,
            apiKey: algolia_apiKey,
            indexName: algolia_index,
            inputSelector: "#search-input",
            algoliaOptions: algoliaOptions
        }))
    }
</script>
<script class='corda-cookie-banner'>
    const docsearchLoad = (resolve, reject) => {
        const script = document.createElement('script');
        document.body.appendChild(script);
        script.onload = resolve;
        script.onerror = reject;
        script.async = true;
        script.src = "https://cdn.jsdelivr.net/npm/docsearch.js@2.6.3/dist/cdn/docsearch.min.js";
    };

    class DocsiteCookies {
        constructor() {
            this.name = 'corda_cookie';
            this.cookiesAccepted = {
                set: true,
                necessary: true,
                preferences: false,
                statistics: false,
                marketing: false
            };
            this.form = document.querySelector('#cookie-consent-form');
            this.handleAllCookies();

            new CookiesEuBanner(() => {
                this.cookieBanner();
            }, true);
        }

        handleAllCookies() {
            const acceptButton = document.querySelector('#cookies-eu-accept');
            const allCookiesButton = document.querySelector('#cookies-eu-accept-all');

            allCookiesButton.addEventListener('click', e => {
                e.preventDefault();
                this.allowAllCookies(this.form);
                acceptButton.click();
            });
        }

        cookieBanner() {
            if (!this.checkConsent()) {
                this.formToCookie(this.name, this.form);
                this.setAdditionalServices();
            } else {
                this.setAdditionalServices();
            }
        }

        allowAllCookies(form) {
            let cookiePreferences = form.querySelectorAll('.cookies-checkbox');
            for (let cookie of cookiePreferences) {
                cookie.querySelector('input').checked = true;
            }
        }

        formToCookie(name, form) {
            const thirteenMonthsInMils = 31104000000;

            let date = new Date();
            date.setTime(date.getTime() + thirteenMonthsInMils);

            let formData = new FormData(form);
            for (var pair of formData.entries()) {
                switch (pair[0]) {
                    case "necessary":
                        this.cookiesAccepted.necessary = (pair[1] === 'on') ?
                            true :
                            false;
                        break;
                    case "preferences":
                        this.cookiesAccepted.preferences = (pair[1] === 'on') ?
                            true :
                            false;
                        break;
                    case "statistics":
                        this.cookiesAccepted.statistics = (pair[1] === 'on') ?
                            true :
                            false;
                        break;
                    case "marketing":
                        this.cookiesAccepted.marketing = (pair[1] === 'on') ?
                            true :
                            false;
                        break;
                    default:
                        break;
                }
            }
            let cookieValue = JSON.stringify(this.cookiesAccepted);

            document.cookie = `${name}=${cookieValue};SameSite=Strict;expires=${date.toGMTString()};path=/`;
        }

        checkConsent() {
            let cookieName = this.name;
            let cookieValue = this.getCookie(cookieName);

            if (cookieValue) {
                if (cookieValue.set === true) {
                    return true;
                } else {
                    return false;
                }
            } else {
                return false;
            }
        }

        getCookie(name) {
            let value = "; " + document.cookie;
            let parts = value.split("; " + name + "=");
            let cValue = "";

            if (parts.length == 2) {
                cValue = parts.pop().split(";").shift();
            }

            if (hasJsonStructure(cValue)) {
                return JSON.parse(cValue);
            } else {
                return cValue;
            }
        }

        setAdditionalServices() {
            let cookieConsent = this.getCookie(this.name);
            for (let [key, value] of Object.entries(cookieConsent)) {
                if (key === 'necessary' && value === true) {
                    new Promise(docsearchLoad)
                        .then(() => {
                            docSearchInit();
                        })
                        .catch(err => console.log(err));
                }
                if (key === 'statistics' && value === true) {
                    googleAnalytics();
                }
            }
        }
    }

    function hasJsonStructure(str) {
        if (typeof str !== 'string') return false;
        try {
            const result = JSON.parse(str);
            const type = Object.prototype.toString.call(result);
            return type === '[object Object]' ||
                type === '[object Array]';
        } catch (err) {
            return false;
        }
    }
</script>
<script class='initialise'>
    new DocsiteCookies();
</script>
</body>
</html>
